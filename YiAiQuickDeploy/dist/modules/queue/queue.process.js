'use strict';var _0x5889fa=_0x3241;(function(_0x1a6a39,_0x3b53dc){var _0x5733b2=_0x3241,_0xc41c40=_0x1a6a39();while(!![]){try{var _0x4ec5fe=-parseInt(_0x5733b2(0x1e7))/0x1*(-parseInt(_0x5733b2(0x1f7))/0x2)+parseInt(_0x5733b2(0x216))/0x3*(parseInt(_0x5733b2(0x1f8))/0x4)+parseInt(_0x5733b2(0x20e))/0x5*(parseInt(_0x5733b2(0x215))/0x6)+-parseInt(_0x5733b2(0x1f3))/0x7*(-parseInt(_0x5733b2(0x1e6))/0x8)+parseInt(_0x5733b2(0x204))/0x9*(parseInt(_0x5733b2(0x207))/0xa)+-parseInt(_0x5733b2(0x1ff))/0xb*(-parseInt(_0x5733b2(0x200))/0xc)+parseInt(_0x5733b2(0x20a))/0xd*(-parseInt(_0x5733b2(0x208))/0xe);if(_0x4ec5fe===_0x3b53dc)break;else _0xc41c40['push'](_0xc41c40['shift']());}catch(_0x4d6a02){_0xc41c40['push'](_0xc41c40['shift']());}}}(_0x38e0,0x8d579));function _0x38e0(){var _0x2f7794=['18ghITeL','name','onQueueCleaned','1903830yVgBJr','2212mojwII','Process','218296MaMTyM','OnQueueCleaned','onQueueError','\x20jobs\x20of\x20type\x20','37045PEihje','onQueueProgress','length','log','OnQueueCompleted','__esModule','__metadata','828IbSEvu','59553neUgOu','onQueueFailed','object','getOwnPropertyDescriptor','OnQueueResumed','队列任务的一个回调用于通知当前进度','function','Logger','@nestjs/bull','metadata','handleJob','OnQueuePaused','111384EdIPfI','43849WLryFT','队列恢复的时候调用','Queue\x20cleaned:\x20','OnQueueActive','MJDRAW','OnQueueFailed','QueueProcessor','logger','队列暂停的时候调用','midjourneyService','decorate','design:paramtypes','399sMBDoH','队列发生错误','onQueueCompleted','\x20were\x20cleaned.','22bpSMMV','104KTWIVX','Queue\x20failed:\x20','design:returntype','onQueueResumed','design:type','onQueuePaused','prototype','404679FdWPif','12oGEigV','onQueueActive','mjDraw',':\x20绘画失败\x20'];_0x38e0=function(){return _0x2f7794;};return _0x38e0();}var __decorate=this&&this['__decorate']||function(_0x4c4a1a,_0x4981c9,_0x15bf73,_0x4c4035){var _0x4b4c17=_0x3241,_0x2544d7=arguments[_0x4b4c17(0x210)],_0x1fc003=_0x2544d7<0x3?_0x4981c9:_0x4c4035===null?_0x4c4035=Object[_0x4b4c17(0x219)](_0x4981c9,_0x15bf73):_0x4c4035,_0xb905eb;if(typeof Reflect===_0x4b4c17(0x218)&&typeof Reflect['decorate']==='function')_0x1fc003=Reflect[_0x4b4c17(0x1f1)](_0x4c4a1a,_0x4981c9,_0x15bf73,_0x4c4035);else{for(var _0x287995=_0x4c4a1a['length']-0x1;_0x287995>=0x0;_0x287995--)if(_0xb905eb=_0x4c4a1a[_0x287995])_0x1fc003=(_0x2544d7<0x3?_0xb905eb(_0x1fc003):_0x2544d7>0x3?_0xb905eb(_0x4981c9,_0x15bf73,_0x1fc003):_0xb905eb(_0x4981c9,_0x15bf73))||_0x1fc003;}return _0x2544d7>0x3&&_0x1fc003&&Object['defineProperty'](_0x4981c9,_0x15bf73,_0x1fc003),_0x1fc003;},__metadata=this&&this[_0x5889fa(0x214)]||function(_0x1b4269,_0xb6ceaa){var _0x499608=_0x5889fa;if(typeof Reflect===_0x499608(0x218)&&typeof Reflect[_0x499608(0x1e3)]===_0x499608(0x1e0))return Reflect[_0x499608(0x1e3)](_0x1b4269,_0xb6ceaa);},QueueProcessor_1;Object['defineProperty'](exports,_0x5889fa(0x213),{'value':!![]}),exports[_0x5889fa(0x1ed)]=void 0x0;function _0x3241(_0x12f0ba,_0x36fb23){var _0x38e00e=_0x38e0();return _0x3241=function(_0x3241f5,_0x2e338a){_0x3241f5=_0x3241f5-0x1de;var _0x2f3696=_0x38e00e[_0x3241f5];return _0x2f3696;},_0x3241(_0x12f0ba,_0x36fb23);}const bull_1=require(_0x5889fa(0x1e2)),common_1=require('@nestjs/common'),midjourney_service_1=require('../midjourney/midjourney.service');let QueueProcessor=QueueProcessor_1=class QueueProcessor{constructor(_0x2c4cd7){var _0x4f6b12=_0x5889fa;this[_0x4f6b12(0x1f0)]=_0x2c4cd7,this[_0x4f6b12(0x1ee)]=new common_1[(_0x4f6b12(0x1e1))](QueueProcessor_1[_0x4f6b12(0x205)]);}async[_0x5889fa(0x1e4)](_0x413517){var _0x2320ef=_0x5889fa;const _0x3403e3=await this[_0x2320ef(0x1f0)]['draw'](_0x413517['data'],_0x413517['id']);return _0x3403e3;}[_0x5889fa(0x201)](_0x351388){}[_0x5889fa(0x20c)](_0x17ebf4){var _0x36b19c=_0x5889fa;console[_0x36b19c(0x211)](_0x36b19c(0x1f4),_0x17ebf4);}[_0x5889fa(0x20f)](_0x504e2b,_0xde3252){var _0x557fbe=_0x5889fa;console['log'](_0x557fbe(0x1df),_0x504e2b['id'],_0xde3252);}['onQueueCompleted'](_0x1f323e,_0x300a86){}[_0x5889fa(0x217)](_0x25139d,_0x2f4214){var _0x3360aa=_0x5889fa;common_1[_0x3360aa(0x1e1)]['error'](_0x3360aa(0x1f9)+_0x2f4214['message']+_0x3360aa(0x203)+_0x25139d['id'],_0x3360aa(0x1ed)),this[_0x3360aa(0x1f0)]['drawFailed'](_0x25139d['data']);}['onQueuePaused'](){var _0x4a545c=_0x5889fa;console['log'](_0x4a545c(0x1ef));}[_0x5889fa(0x1fb)](){var _0x4531d4=_0x5889fa;console['log'](_0x4531d4(0x1e8));}[_0x5889fa(0x206)](_0x29128d,_0x69794){var _0xa5c1c=_0x5889fa;common_1[_0xa5c1c(0x1e1)]['log'](_0xa5c1c(0x1e9)+_0x29128d[_0xa5c1c(0x210)]+_0xa5c1c(0x20d)+_0x69794+_0xa5c1c(0x1f6),_0xa5c1c(0x1ed));}['onQueueDrained'](){}};__decorate([(0x0,bull_1[_0x5889fa(0x209)])({'name':_0x5889fa(0x202),'concurrency':process['env']['CONCURRENCY']?+process['env']['CONCURRENCY']:0x3}),__metadata(_0x5889fa(0x1fc),Function),__metadata('design:paramtypes',[Object]),__metadata(_0x5889fa(0x1fa),Promise)],QueueProcessor[_0x5889fa(0x1fe)],_0x5889fa(0x1e4),null),__decorate([(0x0,bull_1[_0x5889fa(0x1ea)])(),__metadata(_0x5889fa(0x1fc),Function),__metadata(_0x5889fa(0x1f2),[Object]),__metadata(_0x5889fa(0x1fa),void 0x0)],QueueProcessor[_0x5889fa(0x1fe)],'onQueueActive',null),__decorate([(0x0,bull_1['OnQueueError'])(),__metadata(_0x5889fa(0x1fc),Function),__metadata('design:paramtypes',[Error]),__metadata(_0x5889fa(0x1fa),void 0x0)],QueueProcessor[_0x5889fa(0x1fe)],_0x5889fa(0x20c),null),__decorate([(0x0,bull_1['OnQueueProgress'])(),__metadata(_0x5889fa(0x1fc),Function),__metadata(_0x5889fa(0x1f2),[Object,Number]),__metadata(_0x5889fa(0x1fa),void 0x0)],QueueProcessor['prototype'],'onQueueProgress',null),__decorate([(0x0,bull_1[_0x5889fa(0x212)])(),__metadata(_0x5889fa(0x1fc),Function),__metadata('design:paramtypes',[Object,Object]),__metadata('design:returntype',void 0x0)],QueueProcessor['prototype'],_0x5889fa(0x1f5),null),__decorate([(0x0,bull_1[_0x5889fa(0x1ec)])(),__metadata('design:type',Function),__metadata(_0x5889fa(0x1f2),[Object,Error]),__metadata(_0x5889fa(0x1fa),void 0x0)],QueueProcessor[_0x5889fa(0x1fe)],_0x5889fa(0x217),null),__decorate([(0x0,bull_1[_0x5889fa(0x1e5)])(),__metadata(_0x5889fa(0x1fc),Function),__metadata(_0x5889fa(0x1f2),[]),__metadata(_0x5889fa(0x1fa),void 0x0)],QueueProcessor[_0x5889fa(0x1fe)],_0x5889fa(0x1fd),null),__decorate([(0x0,bull_1[_0x5889fa(0x1de)])(),__metadata(_0x5889fa(0x1fc),Function),__metadata('design:paramtypes',[]),__metadata(_0x5889fa(0x1fa),void 0x0)],QueueProcessor['prototype'],_0x5889fa(0x1fb),null),__decorate([(0x0,bull_1[_0x5889fa(0x20b)])(),__metadata('design:type',Function),__metadata(_0x5889fa(0x1f2),[Array,String]),__metadata(_0x5889fa(0x1fa),void 0x0)],QueueProcessor[_0x5889fa(0x1fe)],_0x5889fa(0x206),null),__decorate([(0x0,bull_1['OnQueueDrained'])(),__metadata('design:type',Function),__metadata(_0x5889fa(0x1f2),[]),__metadata('design:returntype',void 0x0)],QueueProcessor[_0x5889fa(0x1fe)],'onQueueDrained',null),QueueProcessor=QueueProcessor_1=__decorate([(0x0,bull_1['Processor'])(_0x5889fa(0x1eb)),__metadata(_0x5889fa(0x1f2),[midjourney_service_1['MidjourneyService']])],QueueProcessor),exports[_0x5889fa(0x1ed)]=QueueProcessor;