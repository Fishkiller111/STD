'use strict';var _0xf7c5c2=_0x3e81;(function(_0x465200,_0x518eaa){var _0x335169=_0x3e81,_0x47aa01=_0x465200();while(!![]){try{var _0x1bc698=parseInt(_0x335169(0x1e4))/0x1*(parseInt(_0x335169(0x1cb))/0x2)+parseInt(_0x335169(0x1da))/0x3+parseInt(_0x335169(0x1ec))/0x4+-parseInt(_0x335169(0x1d7))/0x5+parseInt(_0x335169(0x1e6))/0x6*(-parseInt(_0x335169(0x1e3))/0x7)+-parseInt(_0x335169(0x1f1))/0x8+-parseInt(_0x335169(0x1d2))/0x9*(-parseInt(_0x335169(0x1ed))/0xa);if(_0x1bc698===_0x518eaa)break;else _0x47aa01['push'](_0x47aa01['shift']());}catch(_0x1ab963){_0x47aa01['push'](_0x47aa01['shift']());}}}(_0x58c7,0x9d0b7));var __decorate=this&&this[_0xf7c5c2(0x1eb)]||function(_0x46e872,_0xa0d202,_0x282b37,_0x195fd1){var _0x17ba1e=_0xf7c5c2,_0x4abe81=arguments[_0x17ba1e(0x1ca)],_0x5b3340=_0x4abe81<0x3?_0xa0d202:_0x195fd1===null?_0x195fd1=Object['getOwnPropertyDescriptor'](_0xa0d202,_0x282b37):_0x195fd1,_0x4c2c56;if(typeof Reflect==='object'&&typeof Reflect[_0x17ba1e(0x1cc)]===_0x17ba1e(0x1dd))_0x5b3340=Reflect[_0x17ba1e(0x1cc)](_0x46e872,_0xa0d202,_0x282b37,_0x195fd1);else{for(var _0x43625d=_0x46e872[_0x17ba1e(0x1ca)]-0x1;_0x43625d>=0x0;_0x43625d--)if(_0x4c2c56=_0x46e872[_0x43625d])_0x5b3340=(_0x4abe81<0x3?_0x4c2c56(_0x5b3340):_0x4abe81>0x3?_0x4c2c56(_0xa0d202,_0x282b37,_0x5b3340):_0x4c2c56(_0xa0d202,_0x282b37))||_0x5b3340;}return _0x4abe81>0x3&&_0x5b3340&&Object[_0x17ba1e(0x1c8)](_0xa0d202,_0x282b37,_0x5b3340),_0x5b3340;},__metadata=this&&this[_0xf7c5c2(0x204)]||function(_0x57e434,_0x3c9cea){var _0x3dfd9d=_0xf7c5c2;if(typeof Reflect===_0x3dfd9d(0x200)&&typeof Reflect[_0x3dfd9d(0x1d4)]===_0x3dfd9d(0x1dd))return Reflect[_0x3dfd9d(0x1d4)](_0x57e434,_0x3c9cea);},QueueProcessor_1;Object[_0xf7c5c2(0x1c8)](exports,_0xf7c5c2(0x1c9),{'value':!![]}),exports[_0xf7c5c2(0x1cd)]=void 0x0;function _0x58c7(){var _0x27a7ca=['decorate','QueueProcessor','onQueueProgress','env','队列发生错误','prototype','9gVFMVM','OnQueueCleaned','metadata','onQueueCompleted','OnQueueProgress','6323545jpIyQH','design:type','Logger','878040kplRFm','onQueueCleaned','logger','function','log','onQueueResumed','error','onQueueFailed','Processor','28COBrEV','1195518OAVzBJ','onQueueDrained','821130cRsSSD','design:returntype','data','MJDRAW','midjourneyService','__decorate','2756876NFKVBX','15517740LLxOPU','队列暂停的时候调用','onQueueActive','handleJob','10190456EpLmZy','OnQueueFailed','\x20jobs\x20of\x20type\x20','MidjourneyService','onQueuePaused','message',':\x20绘画失败\x20','Queue\x20failed:\x20','CONCURRENCY','队列任务的一个回调用于通知当前进度','design:paramtypes','OnQueueDrained','onQueueError','draw','drawFailed','object','OnQueueCompleted','Queue\x20cleaned:\x20','mjDraw','__metadata','defineProperty','__esModule','length','2hIbHDx'];_0x58c7=function(){return _0x27a7ca;};return _0x58c7();}function _0x3e81(_0x4c9c92,_0x5acef2){var _0x58c706=_0x58c7();return _0x3e81=function(_0x3e8118,_0x33c5fc){_0x3e8118=_0x3e8118-0x1c8;var _0x89f319=_0x58c706[_0x3e8118];return _0x89f319;},_0x3e81(_0x4c9c92,_0x5acef2);}const bull_1=require('@nestjs/bull'),common_1=require('@nestjs/common'),midjourney_service_1=require('../midjourney/midjourney.service');let QueueProcessor=QueueProcessor_1=class QueueProcessor{constructor(_0x137c7a){var _0x5741cf=_0xf7c5c2;this[_0x5741cf(0x1ea)]=_0x137c7a,this[_0x5741cf(0x1dc)]=new common_1[(_0x5741cf(0x1d9))](QueueProcessor_1['name']);}async[_0xf7c5c2(0x1f0)](_0x523ede){var _0x4d0146=_0xf7c5c2;const _0x463a91=await this[_0x4d0146(0x1ea)][_0x4d0146(0x1fe)](_0x523ede[_0x4d0146(0x1e8)],_0x523ede['id']);return _0x463a91;}[_0xf7c5c2(0x1ef)](_0x2f1c4a){}[_0xf7c5c2(0x1fd)](_0xde445f){var _0x2df3e5=_0xf7c5c2;console[_0x2df3e5(0x1de)](_0x2df3e5(0x1d0),_0xde445f);}[_0xf7c5c2(0x1ce)](_0x1f7421,_0x2184e6){var _0x272b60=_0xf7c5c2;console[_0x272b60(0x1de)](_0x272b60(0x1fa),_0x1f7421['id'],_0x2184e6);}[_0xf7c5c2(0x1d5)](_0x4bbf00,_0x165fa2){}[_0xf7c5c2(0x1e1)](_0x1a9a0f,_0x404a54){var _0x20896e=_0xf7c5c2;common_1['Logger'][_0x20896e(0x1e0)](_0x20896e(0x1f8)+_0x404a54[_0x20896e(0x1f6)]+_0x20896e(0x1f7)+_0x1a9a0f['id'],_0x20896e(0x1cd)),this[_0x20896e(0x1ea)][_0x20896e(0x1ff)](_0x1a9a0f['data']);}[_0xf7c5c2(0x1f5)](){var _0x2823a7=_0xf7c5c2;console[_0x2823a7(0x1de)](_0x2823a7(0x1ee));}['onQueueResumed'](){var _0x1a35b4=_0xf7c5c2;console[_0x1a35b4(0x1de)]('队列恢复的时候调用');}[_0xf7c5c2(0x1db)](_0x32033f,_0x3df18f){var _0x92e7bb=_0xf7c5c2;common_1[_0x92e7bb(0x1d9)]['log'](_0x92e7bb(0x202)+_0x32033f[_0x92e7bb(0x1ca)]+_0x92e7bb(0x1f3)+_0x3df18f+'\x20were\x20cleaned.',_0x92e7bb(0x1cd));}[_0xf7c5c2(0x1e5)](){}};__decorate([(0x0,bull_1['Process'])({'name':_0xf7c5c2(0x203),'concurrency':process['env'][_0xf7c5c2(0x1f9)]?+process[_0xf7c5c2(0x1cf)][_0xf7c5c2(0x1f9)]:0x3}),__metadata(_0xf7c5c2(0x1d8),Function),__metadata(_0xf7c5c2(0x1fb),[Object]),__metadata(_0xf7c5c2(0x1e7),Promise)],QueueProcessor['prototype'],_0xf7c5c2(0x1f0),null),__decorate([(0x0,bull_1['OnQueueActive'])(),__metadata(_0xf7c5c2(0x1d8),Function),__metadata(_0xf7c5c2(0x1fb),[Object]),__metadata(_0xf7c5c2(0x1e7),void 0x0)],QueueProcessor[_0xf7c5c2(0x1d1)],'onQueueActive',null),__decorate([(0x0,bull_1['OnQueueError'])(),__metadata('design:type',Function),__metadata(_0xf7c5c2(0x1fb),[Error]),__metadata(_0xf7c5c2(0x1e7),void 0x0)],QueueProcessor[_0xf7c5c2(0x1d1)],'onQueueError',null),__decorate([(0x0,bull_1[_0xf7c5c2(0x1d6)])(),__metadata(_0xf7c5c2(0x1d8),Function),__metadata('design:paramtypes',[Object,Number]),__metadata('design:returntype',void 0x0)],QueueProcessor[_0xf7c5c2(0x1d1)],_0xf7c5c2(0x1ce),null),__decorate([(0x0,bull_1[_0xf7c5c2(0x201)])(),__metadata(_0xf7c5c2(0x1d8),Function),__metadata(_0xf7c5c2(0x1fb),[Object,Object]),__metadata(_0xf7c5c2(0x1e7),void 0x0)],QueueProcessor[_0xf7c5c2(0x1d1)],_0xf7c5c2(0x1d5),null),__decorate([(0x0,bull_1[_0xf7c5c2(0x1f2)])(),__metadata(_0xf7c5c2(0x1d8),Function),__metadata(_0xf7c5c2(0x1fb),[Object,Error]),__metadata(_0xf7c5c2(0x1e7),void 0x0)],QueueProcessor['prototype'],'onQueueFailed',null),__decorate([(0x0,bull_1['OnQueuePaused'])(),__metadata(_0xf7c5c2(0x1d8),Function),__metadata(_0xf7c5c2(0x1fb),[]),__metadata('design:returntype',void 0x0)],QueueProcessor['prototype'],_0xf7c5c2(0x1f5),null),__decorate([(0x0,bull_1['OnQueueResumed'])(),__metadata('design:type',Function),__metadata(_0xf7c5c2(0x1fb),[]),__metadata(_0xf7c5c2(0x1e7),void 0x0)],QueueProcessor[_0xf7c5c2(0x1d1)],_0xf7c5c2(0x1df),null),__decorate([(0x0,bull_1[_0xf7c5c2(0x1d3)])(),__metadata('design:type',Function),__metadata('design:paramtypes',[Array,String]),__metadata(_0xf7c5c2(0x1e7),void 0x0)],QueueProcessor[_0xf7c5c2(0x1d1)],_0xf7c5c2(0x1db),null),__decorate([(0x0,bull_1[_0xf7c5c2(0x1fc)])(),__metadata(_0xf7c5c2(0x1d8),Function),__metadata(_0xf7c5c2(0x1fb),[]),__metadata(_0xf7c5c2(0x1e7),void 0x0)],QueueProcessor[_0xf7c5c2(0x1d1)],_0xf7c5c2(0x1e5),null),QueueProcessor=QueueProcessor_1=__decorate([(0x0,bull_1[_0xf7c5c2(0x1e2)])(_0xf7c5c2(0x1e9)),__metadata(_0xf7c5c2(0x1fb),[midjourney_service_1[_0xf7c5c2(0x1f4)]])],QueueProcessor),exports[_0xf7c5c2(0x1cd)]=QueueProcessor;