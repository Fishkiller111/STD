'use strict';var _0x53417c=_0x4721;(function(_0x2fd4db,_0x559e6f){var _0x30ee18=_0x4721,_0x59b5e2=_0x2fd4db();while(!![]){try{var _0x38e9ed=parseInt(_0x30ee18(0xdf))/0x1*(-parseInt(_0x30ee18(0xc7))/0x2)+parseInt(_0x30ee18(0xc4))/0x3+parseInt(_0x30ee18(0xd3))/0x4+-parseInt(_0x30ee18(0xbc))/0x5+parseInt(_0x30ee18(0xee))/0x6+parseInt(_0x30ee18(0xf3))/0x7+-parseInt(_0x30ee18(0xd4))/0x8*(parseInt(_0x30ee18(0xb8))/0x9);if(_0x38e9ed===_0x559e6f)break;else _0x59b5e2['push'](_0x59b5e2['shift']());}catch(_0x270eb0){_0x59b5e2['push'](_0x59b5e2['shift']());}}}(_0x3825,0x24c76));var __decorate=this&&this[_0x53417c(0xeb)]||function(_0x560388,_0x3443d6,_0x453032,_0x179224){var _0x3e16e7=_0x53417c,_0x5b3865=arguments[_0x3e16e7(0xdb)],_0x1594d0=_0x5b3865<0x3?_0x3443d6:_0x179224===null?_0x179224=Object[_0x3e16e7(0xd0)](_0x3443d6,_0x453032):_0x179224,_0x1bc849;if(typeof Reflect==='object'&&typeof Reflect[_0x3e16e7(0xdd)]===_0x3e16e7(0xe8))_0x1594d0=Reflect[_0x3e16e7(0xdd)](_0x560388,_0x3443d6,_0x453032,_0x179224);else{for(var _0x11a091=_0x560388[_0x3e16e7(0xdb)]-0x1;_0x11a091>=0x0;_0x11a091--)if(_0x1bc849=_0x560388[_0x11a091])_0x1594d0=(_0x5b3865<0x3?_0x1bc849(_0x1594d0):_0x5b3865>0x3?_0x1bc849(_0x3443d6,_0x453032,_0x1594d0):_0x1bc849(_0x3443d6,_0x453032))||_0x1594d0;}return _0x5b3865>0x3&&_0x1594d0&&Object[_0x3e16e7(0xc5)](_0x3443d6,_0x453032,_0x1594d0),_0x1594d0;},__metadata=this&&this[_0x53417c(0xc2)]||function(_0x1ecf63,_0x10c0e0){var _0x155b47=_0x53417c;if(typeof Reflect===_0x155b47(0xbf)&&typeof Reflect[_0x155b47(0xed)]===_0x155b47(0xe8))return Reflect[_0x155b47(0xed)](_0x1ecf63,_0x10c0e0);},QueueProcessor_1;function _0x4721(_0x54e3c9,_0x71e0f6){var _0x3825aa=_0x3825();return _0x4721=function(_0x472165,_0x1a7642){_0x472165=_0x472165-0xb7;var _0x1b9949=_0x3825aa[_0x472165];return _0x1b9949;},_0x4721(_0x54e3c9,_0x71e0f6);}Object[_0x53417c(0xc5)](exports,_0x53417c(0xc0),{'value':!![]}),exports['QueueProcessor']=void 0x0;function _0x3825(){var _0x329278=['onQueuePaused','decorate','draw','1uixYIe','onQueueCompleted','midjourneyService','队列任务的一个回调用于通知当前进度','design:returntype','OnQueueError','design:paramtypes','drawFailed','@nestjs/common','function','design:type','OnQueueActive','__decorate','onQueueCleaned','metadata','1349736foKEAY','队列发生错误','OnQueueCleaned','message','MJDRAW','968009TvHRct','\x20jobs\x20of\x20type\x20','9vcdbZA','Queue\x20failed:\x20','OnQueueResumed','log','729680QHNyZb','onQueueFailed','队列恢复的时候调用','object','__esModule','Processor','__metadata','MidjourneyService','356454kPdVjZ','defineProperty','CONCURRENCY','112188RlESZB','handleJob','onQueueActive','prototype','OnQueueDrained','onQueueResumed','队列暂停的时候调用','Process','Logger','getOwnPropertyDescriptor',':\x20绘画失败\x20','OnQueueProgress','155856hdskYs','1346792mDfhXj','Queue\x20cleaned:\x20','OnQueueFailed','OnQueuePaused','QueueProcessor','error','onQueueDrained','length'];_0x3825=function(){return _0x329278;};return _0x3825();}const bull_1=require('@nestjs/bull'),common_1=require(_0x53417c(0xe7)),midjourney_service_1=require('../midjourney/midjourney.service');let QueueProcessor=QueueProcessor_1=class QueueProcessor{constructor(_0x4cf3f3){var _0xa9a6b9=_0x53417c;this[_0xa9a6b9(0xe1)]=_0x4cf3f3,this['logger']=new common_1['Logger'](QueueProcessor_1['name']);}async[_0x53417c(0xc8)](_0x45faf0){var _0x11433d=_0x53417c;const _0x51966a=await this[_0x11433d(0xe1)][_0x11433d(0xde)](_0x45faf0['data'],_0x45faf0['id']);return _0x51966a;}[_0x53417c(0xc9)](_0x3340e1){}['onQueueError'](_0x4abdda){var _0x1a5443=_0x53417c;console[_0x1a5443(0xbb)](_0x1a5443(0xef),_0x4abdda);}['onQueueProgress'](_0x3e08de,_0x403fba){var _0x1d7182=_0x53417c;console[_0x1d7182(0xbb)](_0x1d7182(0xe2),_0x3e08de['id'],_0x403fba);}[_0x53417c(0xe0)](_0x573ee9,_0x488d11){}['onQueueFailed'](_0x2a6ac6,_0x1d0382){var _0x305d12=_0x53417c;common_1[_0x305d12(0xcf)][_0x305d12(0xd9)](_0x305d12(0xb9)+_0x1d0382[_0x305d12(0xf1)]+_0x305d12(0xd1)+_0x2a6ac6['id'],_0x305d12(0xd8)),this['midjourneyService'][_0x305d12(0xe6)](_0x2a6ac6['data']);}[_0x53417c(0xdc)](){var _0x420e95=_0x53417c;console[_0x420e95(0xbb)](_0x420e95(0xcd));}[_0x53417c(0xcc)](){var _0x333a8c=_0x53417c;console['log'](_0x333a8c(0xbe));}[_0x53417c(0xec)](_0xe30b77,_0x873cf){var _0x26732e=_0x53417c;common_1['Logger'][_0x26732e(0xbb)](_0x26732e(0xd5)+_0xe30b77['length']+_0x26732e(0xb7)+_0x873cf+'\x20were\x20cleaned.',_0x26732e(0xd8));}['onQueueDrained'](){}};__decorate([(0x0,bull_1[_0x53417c(0xce)])({'name':'mjDraw','concurrency':process['env'][_0x53417c(0xc6)]?+process['env'][_0x53417c(0xc6)]:0x3}),__metadata('design:type',Function),__metadata(_0x53417c(0xe5),[Object]),__metadata(_0x53417c(0xe3),Promise)],QueueProcessor[_0x53417c(0xca)],_0x53417c(0xc8),null),__decorate([(0x0,bull_1[_0x53417c(0xea)])(),__metadata('design:type',Function),__metadata(_0x53417c(0xe5),[Object]),__metadata(_0x53417c(0xe3),void 0x0)],QueueProcessor[_0x53417c(0xca)],'onQueueActive',null),__decorate([(0x0,bull_1[_0x53417c(0xe4)])(),__metadata('design:type',Function),__metadata(_0x53417c(0xe5),[Error]),__metadata('design:returntype',void 0x0)],QueueProcessor[_0x53417c(0xca)],'onQueueError',null),__decorate([(0x0,bull_1[_0x53417c(0xd2)])(),__metadata(_0x53417c(0xe9),Function),__metadata(_0x53417c(0xe5),[Object,Number]),__metadata(_0x53417c(0xe3),void 0x0)],QueueProcessor[_0x53417c(0xca)],'onQueueProgress',null),__decorate([(0x0,bull_1['OnQueueCompleted'])(),__metadata(_0x53417c(0xe9),Function),__metadata('design:paramtypes',[Object,Object]),__metadata('design:returntype',void 0x0)],QueueProcessor[_0x53417c(0xca)],_0x53417c(0xe0),null),__decorate([(0x0,bull_1[_0x53417c(0xd6)])(),__metadata(_0x53417c(0xe9),Function),__metadata('design:paramtypes',[Object,Error]),__metadata(_0x53417c(0xe3),void 0x0)],QueueProcessor[_0x53417c(0xca)],_0x53417c(0xbd),null),__decorate([(0x0,bull_1[_0x53417c(0xd7)])(),__metadata(_0x53417c(0xe9),Function),__metadata(_0x53417c(0xe5),[]),__metadata(_0x53417c(0xe3),void 0x0)],QueueProcessor[_0x53417c(0xca)],_0x53417c(0xdc),null),__decorate([(0x0,bull_1[_0x53417c(0xba)])(),__metadata(_0x53417c(0xe9),Function),__metadata(_0x53417c(0xe5),[]),__metadata(_0x53417c(0xe3),void 0x0)],QueueProcessor[_0x53417c(0xca)],_0x53417c(0xcc),null),__decorate([(0x0,bull_1[_0x53417c(0xf0)])(),__metadata(_0x53417c(0xe9),Function),__metadata('design:paramtypes',[Array,String]),__metadata(_0x53417c(0xe3),void 0x0)],QueueProcessor[_0x53417c(0xca)],'onQueueCleaned',null),__decorate([(0x0,bull_1[_0x53417c(0xcb)])(),__metadata('design:type',Function),__metadata('design:paramtypes',[]),__metadata(_0x53417c(0xe3),void 0x0)],QueueProcessor[_0x53417c(0xca)],_0x53417c(0xda),null),QueueProcessor=QueueProcessor_1=__decorate([(0x0,bull_1[_0x53417c(0xc1)])(_0x53417c(0xf2)),__metadata(_0x53417c(0xe5),[midjourney_service_1[_0x53417c(0xc3)]])],QueueProcessor),exports['QueueProcessor']=QueueProcessor;