'use strict';function _0x567b(_0x4df03,_0x312625){const _0x19ac89=_0x19ac();return _0x567b=function(_0x567bd5,_0x24775a){_0x567bd5=_0x567bd5-0x176;let _0x5ef01d=_0x19ac89[_0x567bd5];return _0x5ef01d;},_0x567b(_0x4df03,_0x312625);}const _0x597b5f=_0x567b;(function(_0x5057e4,_0x15710b){const _0x5caef0=_0x567b,_0x3cf5f1=_0x5057e4();while(!![]){try{const _0x3a8fa1=-parseInt(_0x5caef0(0x19b))/0x1*(-parseInt(_0x5caef0(0x1a0))/0x2)+parseInt(_0x5caef0(0x187))/0x3+parseInt(_0x5caef0(0x183))/0x4*(parseInt(_0x5caef0(0x179))/0x5)+parseInt(_0x5caef0(0x18d))/0x6*(parseInt(_0x5caef0(0x18c))/0x7)+parseInt(_0x5caef0(0x186))/0x8*(parseInt(_0x5caef0(0x190))/0x9)+parseInt(_0x5caef0(0x178))/0xa*(parseInt(_0x5caef0(0x19d))/0xb)+-parseInt(_0x5caef0(0x177))/0xc*(parseInt(_0x5caef0(0x181))/0xd);if(_0x3a8fa1===_0x15710b)break;else _0x3cf5f1['push'](_0x3cf5f1['shift']());}catch(_0x10c341){_0x3cf5f1['push'](_0x3cf5f1['shift']());}}}(_0x19ac,0x4db6c));Object['defineProperty'](exports,_0x597b5f(0x17c),{'value':!![]}),exports['sendMessageFromZhipu']=exports[_0x597b5f(0x184)]=exports['compilerMetaJsonStr']=exports[_0x597b5f(0x198)]=void 0x0;const axios=require('axios'),jwt=require(_0x597b5f(0x1a2));function generateToken(_0x1ed973,_0x3e23c7=0x3e8*0x3c*0x3c*0x18*0x168){const _0x469122=_0x597b5f,[_0x3a68d6,_0x4ed952]=_0x1ed973[_0x469122(0x176)]('.'),_0x67f082={'api_key':_0x3a68d6,'exp':Math[_0x469122(0x196)](Date[_0x469122(0x197)]())+_0x3e23c7*0x3e8,'timestamp':Math[_0x469122(0x196)](Date[_0x469122(0x197)]())};return jwt['sign'](_0x67f082,_0x4ed952,{'algorithm':_0x469122(0x199),'header':{'alg':'HS256','sign_type':_0x469122(0x19e)}});}exports[_0x597b5f(0x198)]=generateToken;function compilerMetaJsonStr(_0xf54bb5){const _0x586204=_0x597b5f;let _0x38ac31={};try{_0x38ac31=JSON[_0x586204(0x18b)](_0xf54bb5);}catch(_0x3e2f13){_0x38ac31={'usage':{'completion_tokens':0x31,'prompt_tokens':0x14d,'total_tokens':0x18f}},console[_0x586204(0x17e)](_0x586204(0x18f),_0xf54bb5);}return _0x38ac31;}exports[_0x597b5f(0x185)]=compilerMetaJsonStr;function compilerStream(_0x2c6178){const _0x3a6dae=_0x597b5f;var _0x1aa1b0;if(_0x2c6178[_0x3a6dae(0x19c)]===0x3)return{'event':_0x2c6178[0x0][_0x3a6dae(0x191)](_0x3a6dae(0x18a),''),'id':_0x2c6178[0x1][_0x3a6dae(0x191)](_0x3a6dae(0x193),''),'is_end':![],'result':_0x2c6178[0x2]['replace'](_0x3a6dae(0x192),'')[_0x3a6dae(0x195)]()};if(_0x2c6178[_0x3a6dae(0x19c)]===0x4)return{'event':_0x2c6178[0x0][_0x3a6dae(0x191)]('event:',''),'id':_0x2c6178[0x1][_0x3a6dae(0x191)](_0x3a6dae(0x193),''),'result':_0x2c6178[0x2][_0x3a6dae(0x191)](_0x3a6dae(0x192),'')[_0x3a6dae(0x195)](),'is_end':!![],'usage':(_0x1aa1b0=compilerMetaJsonStr(_0x2c6178[0x3][_0x3a6dae(0x191)](_0x3a6dae(0x19a),'')))===null||_0x1aa1b0===void 0x0?void 0x0:_0x1aa1b0[_0x3a6dae(0x1a1)]};}exports[_0x597b5f(0x184)]=compilerStream;function _0x19ac(){const _0x5e3e11=['filter','application/json','__esModule','is_end','error','log','sendMessageFromZhipu','91JJAIOL','POST','260oFImKR','compilerStream','compilerMetaJsonStr','184RRUZCs','1392042xVzFaf','text','end','event:','parse','7JZgJis','18456QAmCFn','data','json\x20parse\x20error\x20from\x20zhipu!','60129lZXagz','replace','data:','id:','/sse-invoke','trim','round','now','generateToken','HS256','meta:','246739iybZMj','length','44LMRMWz','SIGN','then','2wWidqf','usage','jsonwebtoken','split','1234908gstcBI','220130tRXQlT','6395mPwaWg'];_0x19ac=function(){return _0x5e3e11;};return _0x19ac();}async function sendMessageFromZhipu(_0x56c804,{onProgress:_0x150049,key:_0x9dfa88,model:_0xfb3bb3,temperature:temperature=0.95}){const _0x2f3556=await generateToken(_0x9dfa88);return new Promise((_0x3b6305,_0xfe8ec4)=>{const _0x12bc61=_0x567b,_0x15ddf3='https://open.bigmodel.cn/api/paas/v3/model-api/'+_0xfb3bb3+_0x12bc61(0x194),_0x23391c={'method':_0x12bc61(0x182),'url':_0x15ddf3,'responseType':'stream','headers':{'Content-Type':_0x12bc61(0x17b),'Authorization':_0x2f3556},'data':{'prompt':_0x56c804,'temperature':temperature}};axios(_0x23391c)[_0x12bc61(0x19f)](_0x20393c=>{const _0x43c0ec=_0x12bc61,_0x1b2163=_0x20393c['data'];let _0x2159f3,_0x36d918='';_0x1b2163['on'](_0x43c0ec(0x18e),_0x2d4699=>{const _0x46ae4e=_0x43c0ec,_0x454ed9=_0x2d4699['toString']()[_0x46ae4e(0x176)]('\x0a')[_0x46ae4e(0x17a)](_0x3ee6bf=>_0x3ee6bf[_0x46ae4e(0x195)]()!==''),_0xf444e1=compilerStream(_0x454ed9);if(!_0xf444e1)return;const {id:_0x85b675,result:_0x34c6b3,is_end:_0x20d6f3}=_0xf444e1;_0x34c6b3&&(_0x36d918+=_0x34c6b3[_0x46ae4e(0x195)]()),_0x20d6f3&&(_0xf444e1[_0x46ae4e(0x17d)]=![],_0x2159f3=_0xf444e1,_0x2159f3[_0x46ae4e(0x188)]=_0x36d918),_0x150049(_0xf444e1);}),_0x1b2163['on'](_0x43c0ec(0x189),()=>{_0x3b6305(_0x2159f3),_0x36d918='';});})['catch'](_0x4fe528=>{const _0x5e243a=_0x12bc61;console[_0x5e243a(0x17f)]('error:\x20',_0x4fe528);});});}exports[_0x597b5f(0x180)]=sendMessageFromZhipu;