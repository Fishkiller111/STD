'use strict';const _0x3c1979=_0x38c2;(function(_0x33d456,_0x6616ce){const _0x27a6b4=_0x38c2,_0x232002=_0x33d456();while(!![]){try{const _0x11814c=parseInt(_0x27a6b4(0xf8))/0x1+parseInt(_0x27a6b4(0xd3))/0x2*(parseInt(_0x27a6b4(0xfa))/0x3)+-parseInt(_0x27a6b4(0xdc))/0x4+parseInt(_0x27a6b4(0xdb))/0x5*(parseInt(_0x27a6b4(0xe5))/0x6)+-parseInt(_0x27a6b4(0xe7))/0x7*(parseInt(_0x27a6b4(0xdd))/0x8)+-parseInt(_0x27a6b4(0xd7))/0x9*(parseInt(_0x27a6b4(0xe4))/0xa)+-parseInt(_0x27a6b4(0xe2))/0xb;if(_0x11814c===_0x6616ce)break;else _0x232002['push'](_0x232002['shift']());}catch(_0x4bae65){_0x232002['push'](_0x232002['shift']());}}}(_0xdcde,0xb07ac));function _0x38c2(_0x4911eb,_0x5948c0){const _0xdcdeed=_0xdcde();return _0x38c2=function(_0x38c2f5,_0x144cea){_0x38c2f5=_0x38c2f5-0xd1;let _0x20d493=_0xdcdeed[_0x38c2f5];return _0x20d493;},_0x38c2(_0x4911eb,_0x5948c0);}Object[_0x3c1979(0xe8)](exports,'__esModule',{'value':!![]}),exports[_0x3c1979(0xfb)]=exports[_0x3c1979(0xe6)]=exports[_0x3c1979(0xef)]=exports[_0x3c1979(0xe3)]=void 0x0;function _0xdcde(){const _0x22743f=['generateToken','10KsHJbV','2550CFjkIH','compilerStream','21AnVdOT','defineProperty','toString','parse','error','HS256','replace','split','compilerMetaJsonStr','then','/sse-invoke','data:','stream','text','POST','end','jsonwebtoken','72410ceJkum','usage','6qZuInt','sendMessageFromZhipu','data','log','883434TbQuZE','trim','id:','axios','5235498xCpScr','now','json\x20parse\x20error\x20from\x20zhipu!','error:\x20','16810csSsVv','160160ANBWSO','260544zHzwTO','SIGN','event:','round','length','10366048zCWJQz'];_0xdcde=function(){return _0x22743f;};return _0xdcde();}const axios=require(_0x3c1979(0xd6)),jwt=require(_0x3c1979(0xf7));function generateToken(_0x45b05a,_0x4c7868=0x3e8*0x3c*0x3c*0x18*0x168){const _0x354eaa=_0x3c1979,[_0x315b66,_0x2198b8]=_0x45b05a[_0x354eaa(0xee)]('.'),_0x26a7d0={'api_key':_0x315b66,'exp':Math[_0x354eaa(0xe0)](Date[_0x354eaa(0xd8)]())+_0x4c7868*0x3e8,'timestamp':Math[_0x354eaa(0xe0)](Date[_0x354eaa(0xd8)]())};return jwt['sign'](_0x26a7d0,_0x2198b8,{'algorithm':_0x354eaa(0xec),'header':{'alg':_0x354eaa(0xec),'sign_type':_0x354eaa(0xde)}});}exports[_0x3c1979(0xe3)]=generateToken;function compilerMetaJsonStr(_0x399312){const _0x177574=_0x3c1979;let _0x46b738={};try{_0x46b738=JSON[_0x177574(0xea)](_0x399312);}catch(_0x24f499){_0x46b738={'usage':{'completion_tokens':0x31,'prompt_tokens':0x14d,'total_tokens':0x18f}},console[_0x177574(0xeb)](_0x177574(0xd9),_0x399312);}return _0x46b738;}exports[_0x3c1979(0xef)]=compilerMetaJsonStr;function compilerStream(_0xf07dc5){const _0x446c91=_0x3c1979;var _0x5b3164;if(_0xf07dc5[_0x446c91(0xe1)]===0x3)return{'event':_0xf07dc5[0x0]['replace'](_0x446c91(0xdf),''),'id':_0xf07dc5[0x1][_0x446c91(0xed)](_0x446c91(0xd5),''),'is_end':![],'result':_0xf07dc5[0x2][_0x446c91(0xed)](_0x446c91(0xf2),'')[_0x446c91(0xd4)]()};if(_0xf07dc5['length']===0x4)return{'event':_0xf07dc5[0x0][_0x446c91(0xed)](_0x446c91(0xdf),''),'id':_0xf07dc5[0x1][_0x446c91(0xed)](_0x446c91(0xd5),''),'result':_0xf07dc5[0x2][_0x446c91(0xed)](_0x446c91(0xf2),'')[_0x446c91(0xd4)](),'is_end':!![],'usage':(_0x5b3164=compilerMetaJsonStr(_0xf07dc5[0x3]['replace']('meta:','')))===null||_0x5b3164===void 0x0?void 0x0:_0x5b3164[_0x446c91(0xf9)]};}exports[_0x3c1979(0xe6)]=compilerStream;async function sendMessageFromZhipu(_0x2ca01c,{onProgress:_0x5be832,key:_0x3d2d38,model:_0x408c0a,temperature:temperature=0.95}){const _0x123bf4=await generateToken(_0x3d2d38);return new Promise((_0x2779a5,_0x1ba5e4)=>{const _0x1244f1=_0x38c2,_0x30e37e='https://open.bigmodel.cn/api/paas/v3/model-api/'+_0x408c0a+_0x1244f1(0xf1),_0x54c989={'method':_0x1244f1(0xf5),'url':_0x30e37e,'responseType':_0x1244f1(0xf3),'headers':{'Content-Type':'application/json','Authorization':_0x123bf4},'data':{'prompt':_0x2ca01c,'temperature':temperature}};axios(_0x54c989)[_0x1244f1(0xf0)](_0x2a8a8e=>{const _0x25f3c3=_0x1244f1,_0x1e847d=_0x2a8a8e[_0x25f3c3(0xd1)];let _0x4de719,_0x122f10='';_0x1e847d['on'](_0x25f3c3(0xd1),_0x24bedb=>{const _0x42f58d=_0x25f3c3,_0x438942=_0x24bedb[_0x42f58d(0xe9)]()[_0x42f58d(0xee)]('\x0a')['filter'](_0x55d9dc=>_0x55d9dc[_0x42f58d(0xd4)]()!==''),_0x2c6351=compilerStream(_0x438942);if(!_0x2c6351)return;const {id:_0x5782f0,result:_0x136400,is_end:_0x50a6d6}=_0x2c6351;_0x136400&&(_0x122f10+=_0x136400[_0x42f58d(0xd4)]()),_0x50a6d6&&(_0x2c6351['is_end']=![],_0x4de719=_0x2c6351,_0x4de719[_0x42f58d(0xf4)]=_0x122f10),_0x5be832(_0x2c6351);}),_0x1e847d['on'](_0x25f3c3(0xf6),()=>{_0x2779a5(_0x4de719),_0x122f10='';});})['catch'](_0x140917=>{const _0x4e2c01=_0x1244f1;console[_0x4e2c01(0xd2)](_0x4e2c01(0xda),_0x140917);});});}exports['sendMessageFromZhipu']=sendMessageFromZhipu;