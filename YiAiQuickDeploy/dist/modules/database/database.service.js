'use strict';const _0x632f95=_0x4e27;function _0x73f8(){const _0x2d2635=['HttpException','typeorm','Logger','onModuleInit','Yi\x20Ai团队账号验证','qqNumber','checkSiteBaseConfig','registerVerifyEmailTitle','configKey','__metadata',']、初始密码为[','vxNumber','function','firstRregisterSendDrawMjCount','registerSendDrawMjCount','defineProperty','\x0a\x20\x20SELECT\x20COUNT(*)\x20AS\x20count\x20FROM\x20config\x20WHERE\x20`configKey`\x20IN\x20(','123456','defaultAdmin@cooper.com','userDefautlAvatar','933dxorgp','\x27,\x20\x27','3358566RtGCPJ','HttpStatus','5694392yOfmVm','registerSendModel4Count','metadata','log','registerVerifyEmailDesc','admin','length','map','inviteSendStatus','初始化网站配置信息成功、如您需要修改网站配置信息，请前往管理系统系统配置设置\x20==============>\x20请注意查阅','https://api.openai.com','registerVerifyExpir','__decorate','robotAvatar','noticeInfo','SELECT\x20*\x20FROM\x20users\x20WHERE\x20role\x20=\x20\x27super\x27','805239273','DatabaseService','count','connection','8812JXCRGI','registerSuccessEmaileAppend','public','error:\x20','replace','query','初始化创建','INSERT\x20INTO\x20balance\x20(userId,\x20balance,\x20usesLeft,\x20paintCount)\x20VALUES\x20(\x27','inviteGiveSendDrawMjCount','baiduCode','\x0a####\x20YiAi\x20欢迎您\x0a\x20-\x20欢迎使用YiAi\x0a\x20-\x20初始管理员账号密码\x20\x20super\x20\x20123456\x20【前台后台登录都可以修改】\x0a\x20-\x20初始预览账号密码\x20\x20admin\x20\x20123456\x20【为后台查看账号\x20仅可查看部分非敏感数据】\x0a','firstRregisterSendModel3Count','createDefaultUser','baiduToken','用户成功、用户名为[','default@cooper.com','创建默认超级管理员失败！','inviteGiveSendModel4Count','design:paramtypes','Yi\x20Ai账号激活成功','registerFailEmailTitle','invitedGuestSendModel4Count','@nestjs/common','创建默认网站配置失败！','super','1800','7264872AOldTj','3628915IYWOOJ','join','decorate','HelloWordYi819','openaiBaseUrl','insertId','registerSuccessEmailTeamName','Yi\x20Ai团队','hashSync','registerSendStatus','object',']\x20==============>\x20请注意查阅','invitedGuestSendModel3Count','baiduSiteId','getOwnPropertyDescriptor','6806681dOsIgp','\x27,\x200,\x201000,\x20100)','Connection','buyCramiAddress','bcryptjs','siteName','configVal','inviteGiveSendModel3Count','Yi\x20Ai账号激活失败','Yi\x20Ai','195104FtvMCw','checkSuperAdmin','createBaseSiteConfig','registerFailEmailTeamName'];_0x73f8=function(){return _0x2d2635;};return _0x73f8();}(function(_0x16c66c,_0x25cdcf){const _0x16bb46=_0x4e27,_0x37ef82=_0x16c66c();while(!![]){try{const _0x3421b3=parseInt(_0x16bb46(0xb6))/0x1+-parseInt(_0x16bb46(0x82))/0x2*(-parseInt(_0x16bb46(0xce))/0x3)+-parseInt(_0x16bb46(0xd2))/0x4+-parseInt(_0x16bb46(0x9d))/0x5+-parseInt(_0x16bb46(0xd0))/0x6+parseInt(_0x16bb46(0xac))/0x7+parseInt(_0x16bb46(0x9c))/0x8;if(_0x3421b3===_0x25cdcf)break;else _0x37ef82['push'](_0x37ef82['shift']());}catch(_0x471e58){_0x37ef82['push'](_0x37ef82['shift']());}}}(_0x73f8,0xb3dd0));var __decorate=this&&this[_0x632f95(0xde)]||function(_0x491a47,_0x44d8f3,_0x5ed049,_0x288b2d){const _0x79344b=_0x632f95;var _0x272cdc=arguments[_0x79344b(0xd8)],_0x362c28=_0x272cdc<0x3?_0x44d8f3:_0x288b2d===null?_0x288b2d=Object[_0x79344b(0xab)](_0x44d8f3,_0x5ed049):_0x288b2d,_0x5656e0;if(typeof Reflect===_0x79344b(0xa7)&&typeof Reflect[_0x79344b(0x9f)]===_0x79344b(0xc6))_0x362c28=Reflect[_0x79344b(0x9f)](_0x491a47,_0x44d8f3,_0x5ed049,_0x288b2d);else{for(var _0x43c968=_0x491a47['length']-0x1;_0x43c968>=0x0;_0x43c968--)if(_0x5656e0=_0x491a47[_0x43c968])_0x362c28=(_0x272cdc<0x3?_0x5656e0(_0x362c28):_0x272cdc>0x3?_0x5656e0(_0x44d8f3,_0x5ed049,_0x362c28):_0x5656e0(_0x44d8f3,_0x5ed049))||_0x362c28;}return _0x272cdc>0x3&&_0x362c28&&Object[_0x79344b(0xc9)](_0x44d8f3,_0x5ed049,_0x362c28),_0x362c28;},__metadata=this&&this[_0x632f95(0xc3)]||function(_0x2b3454,_0x572ab4){const _0x2c8080=_0x632f95;if(typeof Reflect===_0x2c8080(0xa7)&&typeof Reflect[_0x2c8080(0xd4)]===_0x2c8080(0xc6))return Reflect[_0x2c8080(0xd4)](_0x2b3454,_0x572ab4);};function _0x4e27(_0xd7faf4,_0x58d28b){const _0x73f87=_0x73f8();return _0x4e27=function(_0x4e271f,_0x3bdd6e){_0x4e271f=_0x4e271f-0x7b;let _0x9a8c4a=_0x73f87[_0x4e271f];return _0x9a8c4a;},_0x4e27(_0xd7faf4,_0x58d28b);}Object[_0x632f95(0xc9)](exports,'__esModule',{'value':!![]}),exports[_0x632f95(0x7f)]=void 0x0;const common_1=require(_0x632f95(0x98)),typeorm_1=require(_0x632f95(0xbb)),bcrypt=require(_0x632f95(0xb0));let DatabaseService=class DatabaseService{constructor(_0x252517){const _0x41a785=_0x632f95;this[_0x41a785(0x81)]=_0x252517;}async[_0x632f95(0xbd)](){const _0xe76655=_0x632f95;await this[_0xe76655(0xb7)](),await this[_0xe76655(0xc0)]();}async['checkSuperAdmin'](){const _0x514f81=_0x632f95,_0xe4193e=await this['connection']['query'](_0x514f81(0x7d));if(!_0xe4193e||_0xe4193e[_0x514f81(0xd8)]===0x0){const _0x567992=bcrypt['hashSync'](_0x514f81(0xcb),0xa),_0x3e4005=bcrypt[_0x514f81(0xa5)](_0x514f81(0xcb),0xa),_0x24d330=_0x514f81(0x91),_0x3d991a=_0x514f81(0xcc),_0x524d84={'username':_0x514f81(0x9a),'password':_0x567992,'status':0x1,'email':_0x24d330,'sex':0x1,'role':_0x514f81(0x9a)},_0x3bd4a5={'username':_0x514f81(0xd7),'password':_0x3e4005,'status':0x1,'email':_0x3d991a,'sex':0x1,'role':_0x514f81(0xd7)};await this['createDefaultUser'](_0x524d84),await this[_0x514f81(0x8e)](_0x3bd4a5);}}async[_0x632f95(0x8e)](_0x3e6d05){const _0x285345=_0x632f95;try{const {username:_0x2a3af6,password:_0x28924d,status:_0x66b8ea,email:_0xf332bc,role:_0x382e22}=_0x3e6d05,_0x5875fc=await this[_0x285345(0x81)][_0x285345(0x87)]('INSERT\x20INTO\x20users\x20(username,\x20password,\x20status,\x20email,\x20role)\x20VALUES\x20(\x27'+_0x2a3af6+_0x285345(0xcf)+_0x28924d+'\x27,\x20\x27'+_0x66b8ea+_0x285345(0xcf)+_0xf332bc+_0x285345(0xcf)+_0x382e22+'\x27)'),_0xcdf010=_0x5875fc[_0x285345(0xa2)],_0xd560c1=await this[_0x285345(0x81)][_0x285345(0x87)](_0x285345(0x89)+_0xcdf010+_0x285345(0xad));common_1[_0x285345(0xbc)][_0x285345(0xd5)](_0x285345(0x88)+_0x382e22+_0x285345(0x90)+_0x2a3af6+_0x285345(0xc4)+(_0x2a3af6===_0x285345(0x9a)?'nine-super':_0x285345(0xcb))+_0x285345(0xa8),_0x285345(0x7f));}catch(_0x298105){console['log']('error:\x20',_0x298105);throw new common_1[(_0x285345(0xba))](_0x285345(0x92),common_1[_0x285345(0xd1)]['INTERNAL_SERVER_ERROR']);}}async['checkSiteBaseConfig'](){const _0xde72fd=_0x632f95,_0x4c14c2=['siteName',_0xde72fd(0xbf),_0xde72fd(0xc5),_0xde72fd(0x7b),'userDefautlAvatar'],_0x424cc5=await this[_0xde72fd(0x81)][_0xde72fd(0x87)](_0xde72fd(0xca)+_0x4c14c2[_0xde72fd(0xd9)](_0x5aa748=>'\x27'+_0x5aa748+'\x27')[_0xde72fd(0x9e)](',')+')\x0a'),_0x3ca5ec=parseInt(_0x424cc5[0x0][_0xde72fd(0x80)]);_0x3ca5ec===0x0&&await this[_0xde72fd(0xb8)]();}async['createBaseSiteConfig'](){const _0x1cdda0=_0x632f95;try{const _0x22f01a='',_0x4e8b38=_0x1cdda0(0x8c),_0x4112e5=[{'configKey':_0x1cdda0(0xb1),'configVal':_0x1cdda0(0xb5),'public':0x1,'encry':0x0},{'configKey':_0x1cdda0(0xbf),'configVal':_0x1cdda0(0x7e),'public':0x1,'encry':0x0},{'configKey':_0x1cdda0(0xc5),'configVal':_0x1cdda0(0xa0),'public':0x1,'encry':0x0},{'configKey':_0x1cdda0(0x7b),'configVal':'','public':0x1,'encry':0x0},{'configKey':_0x1cdda0(0xcd),'configVal':'','public':0x0,'encry':0x0},{'configKey':_0x1cdda0(0x8b),'configVal':_0x22f01a,'public':0x1,'encry':0x0},{'configKey':_0x1cdda0(0xaa),'configVal':'','public':0x0,'encry':0x0},{'configKey':_0x1cdda0(0x8f),'configVal':'','public':0x0,'encry':0x0},{'configKey':_0x1cdda0(0xaf),'configVal':'','public':0x1,'encry':0x0},{'configKey':_0x1cdda0(0xa1),'configVal':_0x1cdda0(0xdc),'public':0x0,'encry':0x0},{'configKey':_0x1cdda0(0x7c),'configVal':_0x4e8b38,'public':0x1,'encry':0x0},{'configKey':_0x1cdda0(0xc1),'configVal':_0x1cdda0(0xbe),'public':0x0,'encry':0x0},{'configKey':_0x1cdda0(0xd6),'configVal':'欢迎使用Yi\x20Ai团队的产品服务,请在五分钟内完成你的账号激活,点击以下按钮激活您的账号，','public':0x0,'encry':0x0},{'configKey':'registerVerifyEmailFrom','configVal':_0x1cdda0(0xa4),'public':0x0,'encry':0x0},{'configKey':_0x1cdda0(0xdd),'configVal':_0x1cdda0(0x9b),'public':0x0,'encry':0x0},{'configKey':'registerSuccessEmailTitle','configVal':_0x1cdda0(0x95),'public':0x0,'encry':0x0},{'configKey':_0x1cdda0(0xa3),'configVal':_0x1cdda0(0xb5),'public':0x0,'encry':0x0},{'configKey':_0x1cdda0(0x83),'configVal':',请妥善保管您的账号，祝您使用愉快','public':0x0,'encry':0x0},{'configKey':_0x1cdda0(0x96),'configVal':_0x1cdda0(0xb4),'public':0x0,'encry':0x0},{'configKey':_0x1cdda0(0xb9),'configVal':'Yi\x20Ai团队','public':0x0,'encry':0x0},{'configKey':_0x1cdda0(0xa6),'configVal':'1','public':0x1,'encry':0x0},{'configKey':'registerSendModel3Count','configVal':'30','public':0x1,'encry':0x0},{'configKey':_0x1cdda0(0xd3),'configVal':'3','public':0x1,'encry':0x0},{'configKey':_0x1cdda0(0xc8),'configVal':'3','public':0x1,'encry':0x0},{'configKey':'firstRegisterSendStatus','configVal':'1','public':0x1,'encry':0x0},{'configKey':'firstRegisterSendRank','configVal':'500','public':0x1,'encry':0x0},{'configKey':_0x1cdda0(0x8d),'configVal':'10','public':0x1,'encry':0x0},{'configKey':'firstRregisterSendModel4Count','configVal':'10','public':0x1,'encry':0x0},{'configKey':_0x1cdda0(0xc7),'configVal':'10','public':0x1,'encry':0x0},{'configKey':_0x1cdda0(0xda),'configVal':'1','public':0x1,'encry':0x0},{'configKey':_0x1cdda0(0xb3),'configVal':'0','public':0x1,'encry':0x0},{'configKey':_0x1cdda0(0x93),'configVal':'0','public':0x1,'encry':0x0},{'configKey':_0x1cdda0(0x8a),'configVal':'0','public':0x1,'encry':0x0},{'configKey':_0x1cdda0(0xa9),'configVal':'10','public':0x1,'encry':0x0},{'configKey':_0x1cdda0(0x97),'configVal':'10','public':0x1,'encry':0x0},{'configKey':'invitedGuestSendDrawMjCount','configVal':'10','public':0x1,'encry':0x0},{'configKey':'isVerifyEmail','configVal':'1','public':0x1,'encry':0x0}],_0x1f313e=await this[_0x1cdda0(0x81)]['query']('INSERT\x20INTO\x20config\x20(configKey,\x20configVal,\x20public,\x20encry)\x20VALUES\x20'+_0x4112e5['map'](_0x1546bd=>'(\x27'+_0x1546bd[_0x1cdda0(0xc2)]+_0x1cdda0(0xcf)+_0x1546bd[_0x1cdda0(0xb2)][_0x1cdda0(0x86)](/'/g,'\x5c\x27')+_0x1cdda0(0xcf)+_0x1546bd[_0x1cdda0(0x84)]+_0x1cdda0(0xcf)+_0x1546bd['encry']+'\x27)')['join'](',\x20'));common_1[_0x1cdda0(0xbc)]['log'](_0x1cdda0(0xdb),'DatabaseService');}catch(_0x2d9837){console['log'](_0x1cdda0(0x85),_0x2d9837);throw new common_1[(_0x1cdda0(0xba))](_0x1cdda0(0x99),common_1[_0x1cdda0(0xd1)]['INTERNAL_SERVER_ERROR']);}}};DatabaseService=__decorate([(0x0,common_1['Injectable'])(),__metadata(_0x632f95(0x94),[typeorm_1[_0x632f95(0xae)]])],DatabaseService),exports[_0x632f95(0x7f)]=DatabaseService;