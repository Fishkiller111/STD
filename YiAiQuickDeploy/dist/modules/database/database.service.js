'use strict';const _0x38ebc0=_0x4daf;(function(_0x4f9ece,_0x51b47){const _0x1c10c2=_0x4daf,_0x31a269=_0x4f9ece();while(!![]){try{const _0x380420=-parseInt(_0x1c10c2(0x140))/0x1+parseInt(_0x1c10c2(0x11b))/0x2*(parseInt(_0x1c10c2(0x12a))/0x3)+-parseInt(_0x1c10c2(0x11f))/0x4*(-parseInt(_0x1c10c2(0xdc))/0x5)+parseInt(_0x1c10c2(0x129))/0x6*(parseInt(_0x1c10c2(0xe7))/0x7)+parseInt(_0x1c10c2(0x103))/0x8+-parseInt(_0x1c10c2(0x12e))/0x9*(parseInt(_0x1c10c2(0x13c))/0xa)+-parseInt(_0x1c10c2(0x12d))/0xb;if(_0x380420===_0x51b47)break;else _0x31a269['push'](_0x31a269['shift']());}catch(_0x382d2a){_0x31a269['push'](_0x31a269['shift']());}}}(_0x2e35,0x7611c));var __decorate=this&&this[_0x38ebc0(0x122)]||function(_0x4622c0,_0x41c2d5,_0xd01eaa,_0x301915){const _0x8052d5=_0x38ebc0;var _0x2476ff=arguments['length'],_0x10373e=_0x2476ff<0x3?_0x41c2d5:_0x301915===null?_0x301915=Object[_0x8052d5(0x134)](_0x41c2d5,_0xd01eaa):_0x301915,_0x433414;if(typeof Reflect===_0x8052d5(0xf9)&&typeof Reflect['decorate']===_0x8052d5(0xda))_0x10373e=Reflect[_0x8052d5(0xea)](_0x4622c0,_0x41c2d5,_0xd01eaa,_0x301915);else{for(var _0x1c092b=_0x4622c0[_0x8052d5(0x132)]-0x1;_0x1c092b>=0x0;_0x1c092b--)if(_0x433414=_0x4622c0[_0x1c092b])_0x10373e=(_0x2476ff<0x3?_0x433414(_0x10373e):_0x2476ff>0x3?_0x433414(_0x41c2d5,_0xd01eaa,_0x10373e):_0x433414(_0x41c2d5,_0xd01eaa))||_0x10373e;}return _0x2476ff>0x3&&_0x10373e&&Object[_0x8052d5(0xdd)](_0x41c2d5,_0xd01eaa,_0x10373e),_0x10373e;},__metadata=this&&this[_0x38ebc0(0xdf)]||function(_0x1bae22,_0x2218ff){const _0x14b972=_0x38ebc0;if(typeof Reflect===_0x14b972(0xf9)&&typeof Reflect[_0x14b972(0x131)]===_0x14b972(0xda))return Reflect[_0x14b972(0x131)](_0x1bae22,_0x2218ff);};Object[_0x38ebc0(0xdd)](exports,_0x38ebc0(0x13d),{'value':!![]}),exports['DatabaseService']=void 0x0;const common_1=require(_0x38ebc0(0x120)),typeorm_1=require(_0x38ebc0(0xf8)),bcrypt=require(_0x38ebc0(0x119));function _0x4daf(_0x586d17,_0x309826){const _0x2e354b=_0x2e35();return _0x4daf=function(_0x4dafc0,_0x523b7f){_0x4dafc0=_0x4dafc0-0xd9;let _0x2a8daf=_0x2e354b[_0x4dafc0];return _0x2a8daf;},_0x4daf(_0x586d17,_0x309826);}function _0x2e35(){const _0x47157a=['public','metadata','length','firstRregisterSendDrawMjCount','getOwnPropertyDescriptor','registerSuccessEmailTitle','map','inviteGiveSendModel3Count','欢迎使用Yi\x20Ai团队的产品服务,请在五分钟内完成你的账号激活,点击以下按钮激活您的账号，','registerSendStatus','openaiBaseUrl','Injectable','1332690IuqbDX','__esModule','INTERNAL_SERVER_ERROR','inviteSendStatus','813040emqpWR','初始化创建','function','invitedGuestSendModel3Count','45cEeGwK','defineProperty','configVal','__metadata','hashSync','123456','\x27,\x20\x27','robotAvatar','HttpException','siteName','registerSendDrawMjCount','140oDPlpO','configKey','userDefautlAvatar','decorate','Connection',']\x20==============>\x20请注意查阅',',请妥善保管您的账号，祝您使用愉快','Yi\x20Ai团队账号验证','noticeInfo','qqNumber','log','registerVerifyEmailDesc','onModuleInit','insertId','HttpStatus','registerVerifyEmailTitle','DatabaseService','typeorm','object','error:\x20','\x0a####\x20YiAi\x20欢迎您\x0a\x20-\x20欢迎使用YiAi\x0a\x20-\x20初始管理员账号密码\x20\x20super\x20\x20123456\x20【前台后台登录都可以修改】\x0a\x20-\x20初始预览账号密码\x20\x20admin\x20\x20123456\x20【为后台查看账号\x20仅可查看部分非敏感数据】\x0a','registerSuccessEmailTeamName','buyCramiAddress','admin','checkSiteBaseConfig','创建默认超级管理员失败！','registerVerifyExpir','join','3453560SKXFpY','805239273','invitedGuestSendModel4Count','\x0a\x20\x20SELECT\x20COUNT(*)\x20AS\x20count\x20FROM\x20config\x20WHERE\x20`configKey`\x20IN\x20(','https://api.openai.com','firstRegisterSendRank','firstRegisterSendStatus','INSERT\x20INTO\x20users\x20(username,\x20password,\x20status,\x20email,\x20role)\x20VALUES\x20(\x27','checkSuperAdmin','Yi\x20Ai团队','INSERT\x20INTO\x20config\x20(configKey,\x20configVal,\x20public,\x20encry)\x20VALUES\x20','connection','registerSuccessEmaileAppend','createBaseSiteConfig','Yi\x20Ai账号激活失败','HelloWordYi819','defaultAdmin@cooper.com','\x27,\x200,\x201000,\x20100)','count','registerFailEmailTitle','createDefaultUser','初始化网站配置信息成功、如您需要修改网站配置信息，请前往管理系统系统配置设置\x20==============>\x20请注意查阅','bcryptjs','创建默认网站配置失败！','2pjjltp','inviteGiveSendDrawMjCount','registerFailEmailTeamName','encry','63540guIzhb','@nestjs/common','Yi\x20Ai','__decorate','Yi\x20Ai账号激活成功','Logger','1800','registerVerifyEmailFrom','invitedGuestSendDrawMjCount','query','190722ylFZYl','2405931KFVnbI','firstRregisterSendModel4Count','replace','4941057xNWfhz','18pAFLvm','super'];_0x2e35=function(){return _0x47157a;};return _0x2e35();}let DatabaseService=class DatabaseService{constructor(_0x4c4280){const _0x27849b=_0x38ebc0;this[_0x27849b(0x10e)]=_0x4c4280;}async[_0x38ebc0(0xf3)](){const _0x8235e7=_0x38ebc0;await this[_0x8235e7(0x10b)](),await this[_0x8235e7(0xff)]();}async[_0x38ebc0(0x10b)](){const _0x31b674=_0x38ebc0,_0x3b46be=await this[_0x31b674(0x10e)][_0x31b674(0x128)]('SELECT\x20*\x20FROM\x20users\x20WHERE\x20role\x20=\x20\x27super\x27');if(!_0x3b46be||_0x3b46be[_0x31b674(0x132)]===0x0){const _0x4ae3c9=bcrypt[_0x31b674(0xe0)](_0x31b674(0xe1),0xa),_0x3888bc=bcrypt[_0x31b674(0xe0)](_0x31b674(0xe1),0xa),_0x5c1e35='default@cooper.com',_0x145a32=_0x31b674(0x113),_0x2e6016={'username':_0x31b674(0x12f),'password':_0x4ae3c9,'status':0x1,'email':_0x5c1e35,'sex':0x1,'role':_0x31b674(0x12f)},_0x5ee6e0={'username':'admin','password':_0x3888bc,'status':0x1,'email':_0x145a32,'sex':0x1,'role':_0x31b674(0xfe)};await this[_0x31b674(0x117)](_0x2e6016),await this['createDefaultUser'](_0x5ee6e0);}}async[_0x38ebc0(0x117)](_0x5b25eb){const _0x5d787c=_0x38ebc0;try{const {username:_0xe2c98a,password:_0x4dad4e,status:_0x205add,email:_0x4016e6,role:_0x191918}=_0x5b25eb,_0x22b66c=await this[_0x5d787c(0x10e)]['query'](_0x5d787c(0x10a)+_0xe2c98a+_0x5d787c(0xe2)+_0x4dad4e+'\x27,\x20\x27'+_0x205add+_0x5d787c(0xe2)+_0x4016e6+_0x5d787c(0xe2)+_0x191918+'\x27)'),_0x14e57b=_0x22b66c[_0x5d787c(0xf4)],_0xcb46dc=await this[_0x5d787c(0x10e)][_0x5d787c(0x128)]('INSERT\x20INTO\x20balance\x20(userId,\x20balance,\x20usesLeft,\x20paintCount)\x20VALUES\x20(\x27'+_0x14e57b+_0x5d787c(0x114));common_1[_0x5d787c(0x124)][_0x5d787c(0xf1)](_0x5d787c(0xd9)+_0x191918+'用户成功、用户名为['+_0xe2c98a+']、初始密码为['+(_0xe2c98a==='super'?'nine-super':_0x5d787c(0xe1))+_0x5d787c(0xec),_0x5d787c(0xf7));}catch(_0x42e8dc){console[_0x5d787c(0xf1)](_0x5d787c(0xfa),_0x42e8dc);throw new common_1[(_0x5d787c(0xe4))](_0x5d787c(0x100),common_1[_0x5d787c(0xf5)]['INTERNAL_SERVER_ERROR']);}}async[_0x38ebc0(0xff)](){const _0x46531a=_0x38ebc0,_0x1f1aa7=[_0x46531a(0xe5),_0x46531a(0xf0),'vxNumber','robotAvatar',_0x46531a(0xe9)],_0x3e30d0=await this[_0x46531a(0x10e)]['query'](_0x46531a(0x106)+_0x1f1aa7[_0x46531a(0x136)](_0x5dbaad=>'\x27'+_0x5dbaad+'\x27')[_0x46531a(0x102)](',')+')\x0a'),_0x6f85c7=parseInt(_0x3e30d0[0x0][_0x46531a(0x115)]);_0x6f85c7===0x0&&await this[_0x46531a(0x110)]();}async[_0x38ebc0(0x110)](){const _0x41f834=_0x38ebc0;try{const _0x3deb10='',_0x5931ca=_0x41f834(0xfb),_0x413adb=[{'configKey':_0x41f834(0xe5),'configVal':'Yi\x20Ai','public':0x1,'encry':0x0},{'configKey':'qqNumber','configVal':_0x41f834(0x104),'public':0x1,'encry':0x0},{'configKey':'vxNumber','configVal':_0x41f834(0x112),'public':0x1,'encry':0x0},{'configKey':_0x41f834(0xe3),'configVal':'','public':0x1,'encry':0x0},{'configKey':_0x41f834(0xe9),'configVal':'','public':0x0,'encry':0x0},{'configKey':'baiduCode','configVal':_0x3deb10,'public':0x1,'encry':0x0},{'configKey':'baiduSiteId','configVal':'','public':0x0,'encry':0x0},{'configKey':'baiduToken','configVal':'','public':0x0,'encry':0x0},{'configKey':_0x41f834(0xfd),'configVal':'','public':0x1,'encry':0x0},{'configKey':_0x41f834(0x13a),'configVal':_0x41f834(0x107),'public':0x0,'encry':0x0},{'configKey':_0x41f834(0xef),'configVal':_0x5931ca,'public':0x1,'encry':0x0},{'configKey':_0x41f834(0xf6),'configVal':_0x41f834(0xee),'public':0x0,'encry':0x0},{'configKey':_0x41f834(0xf2),'configVal':_0x41f834(0x138),'public':0x0,'encry':0x0},{'configKey':_0x41f834(0x126),'configVal':_0x41f834(0x10c),'public':0x0,'encry':0x0},{'configKey':_0x41f834(0x101),'configVal':_0x41f834(0x125),'public':0x0,'encry':0x0},{'configKey':_0x41f834(0x135),'configVal':_0x41f834(0x123),'public':0x0,'encry':0x0},{'configKey':_0x41f834(0xfc),'configVal':_0x41f834(0x121),'public':0x0,'encry':0x0},{'configKey':_0x41f834(0x10f),'configVal':_0x41f834(0xed),'public':0x0,'encry':0x0},{'configKey':_0x41f834(0x116),'configVal':_0x41f834(0x111),'public':0x0,'encry':0x0},{'configKey':_0x41f834(0x11d),'configVal':_0x41f834(0x10c),'public':0x0,'encry':0x0},{'configKey':_0x41f834(0x139),'configVal':'1','public':0x1,'encry':0x0},{'configKey':'registerSendModel3Count','configVal':'30','public':0x1,'encry':0x0},{'configKey':'registerSendModel4Count','configVal':'3','public':0x1,'encry':0x0},{'configKey':_0x41f834(0xe6),'configVal':'3','public':0x1,'encry':0x0},{'configKey':_0x41f834(0x109),'configVal':'1','public':0x1,'encry':0x0},{'configKey':_0x41f834(0x108),'configVal':'500','public':0x1,'encry':0x0},{'configKey':'firstRregisterSendModel3Count','configVal':'10','public':0x1,'encry':0x0},{'configKey':_0x41f834(0x12b),'configVal':'10','public':0x1,'encry':0x0},{'configKey':_0x41f834(0x133),'configVal':'10','public':0x1,'encry':0x0},{'configKey':_0x41f834(0x13f),'configVal':'1','public':0x1,'encry':0x0},{'configKey':_0x41f834(0x137),'configVal':'0','public':0x1,'encry':0x0},{'configKey':'inviteGiveSendModel4Count','configVal':'0','public':0x1,'encry':0x0},{'configKey':_0x41f834(0x11c),'configVal':'0','public':0x1,'encry':0x0},{'configKey':_0x41f834(0xdb),'configVal':'10','public':0x1,'encry':0x0},{'configKey':_0x41f834(0x105),'configVal':'10','public':0x1,'encry':0x0},{'configKey':_0x41f834(0x127),'configVal':'10','public':0x1,'encry':0x0},{'configKey':'isVerifyEmail','configVal':'1','public':0x1,'encry':0x0}],_0x36ae8b=await this[_0x41f834(0x10e)][_0x41f834(0x128)](_0x41f834(0x10d)+_0x413adb['map'](_0x45bbd9=>'(\x27'+_0x45bbd9[_0x41f834(0xe8)]+_0x41f834(0xe2)+_0x45bbd9[_0x41f834(0xde)][_0x41f834(0x12c)](/'/g,'\x5c\x27')+_0x41f834(0xe2)+_0x45bbd9[_0x41f834(0x130)]+_0x41f834(0xe2)+_0x45bbd9[_0x41f834(0x11e)]+'\x27)')['join'](',\x20'));common_1[_0x41f834(0x124)][_0x41f834(0xf1)](_0x41f834(0x118),_0x41f834(0xf7));}catch(_0x3da73b){console[_0x41f834(0xf1)](_0x41f834(0xfa),_0x3da73b);throw new common_1['HttpException'](_0x41f834(0x11a),common_1[_0x41f834(0xf5)][_0x41f834(0x13e)]);}}};DatabaseService=__decorate([(0x0,common_1[_0x38ebc0(0x13b)])(),__metadata('design:paramtypes',[typeorm_1[_0x38ebc0(0xeb)]])],DatabaseService),exports['DatabaseService']=DatabaseService;