'use strict';const _0x3a95fb=_0x2099;(function(_0x4eb917,_0x49a012){const _0x2ce4ad=_0x2099,_0x3ce49c=_0x4eb917();while(!![]){try{const _0x36a310=-parseInt(_0x2ce4ad(0xc1))/0x1+parseInt(_0x2ce4ad(0xc0))/0x2*(parseInt(_0x2ce4ad(0x9e))/0x3)+parseInt(_0x2ce4ad(0xba))/0x4+-parseInt(_0x2ce4ad(0x99))/0x5*(parseInt(_0x2ce4ad(0x90))/0x6)+parseInt(_0x2ce4ad(0x9f))/0x7*(parseInt(_0x2ce4ad(0x95))/0x8)+-parseInt(_0x2ce4ad(0xc2))/0x9*(parseInt(_0x2ce4ad(0xa0))/0xa)+parseInt(_0x2ce4ad(0xa9))/0xb;if(_0x36a310===_0x49a012)break;else _0x3ce49c['push'](_0x3ce49c['shift']());}catch(_0x8233af){_0x3ce49c['push'](_0x3ce49c['shift']());}}}(_0x2616,0x2b8dc));var __decorate=this&&this['__decorate']||function(_0x332377,_0x2ab233,_0x5b4c45,_0x41fc9d){const _0x4c357d=_0x2099;var _0x979cb0=arguments[_0x4c357d(0xa3)],_0x36309e=_0x979cb0<0x3?_0x2ab233:_0x41fc9d===null?_0x41fc9d=Object[_0x4c357d(0x97)](_0x2ab233,_0x5b4c45):_0x41fc9d,_0x1ed80c;if(typeof Reflect===_0x4c357d(0xb3)&&typeof Reflect[_0x4c357d(0xbb)]===_0x4c357d(0xbe))_0x36309e=Reflect[_0x4c357d(0xbb)](_0x332377,_0x2ab233,_0x5b4c45,_0x41fc9d);else{for(var _0x5eab0d=_0x332377[_0x4c357d(0xa3)]-0x1;_0x5eab0d>=0x0;_0x5eab0d--)if(_0x1ed80c=_0x332377[_0x5eab0d])_0x36309e=(_0x979cb0<0x3?_0x1ed80c(_0x36309e):_0x979cb0>0x3?_0x1ed80c(_0x2ab233,_0x5b4c45,_0x36309e):_0x1ed80c(_0x2ab233,_0x5b4c45))||_0x36309e;}return _0x979cb0>0x3&&_0x36309e&&Object['defineProperty'](_0x2ab233,_0x5b4c45,_0x36309e),_0x36309e;},__metadata=this&&this[_0x3a95fb(0xbf)]||function(_0x405d28,_0x347753){const _0x21bebe=_0x3a95fb;if(typeof Reflect==='object'&&typeof Reflect[_0x21bebe(0x8b)]==='function')return Reflect[_0x21bebe(0x8b)](_0x405d28,_0x347753);};Object[_0x3a95fb(0xa5)](exports,'__esModule',{'value':!![]}),exports[_0x3a95fb(0xac)]=void 0x0;const redisCache_service_1=require('../../modules/redisCache/redisCache.service'),common_1=require(_0x3a95fb(0x91)),passport_1=require(_0x3a95fb(0xb4)),jwt=require('jsonwebtoken'),core_1=require(_0x3a95fb(0xb9)),globalConfig_service_1=require(_0x3a95fb(0x9b)),auth_service_1=require('../../modules/auth/auth.service');function _0x2099(_0x1af3c4,_0x319585){const _0x26169f=_0x2616();return _0x2099=function(_0x2099c6,_0x45691c){_0x2099c6=_0x2099c6-0x8a;let _0x1969a6=_0x26169f[_0x2099c6];return _0x1969a6;},_0x2099(_0x1af3c4,_0x319585);}function _0x2616(){const _0x259d4d=['defineProperty','AuthService','handleRequest','GlobalConfigService','3482028FHeCaA','headers','verify','JwtAuthGuard','fingerprint','亲爱的用户,请登录后继续操作,我们正在等您的到来！','design:paramtypes','ModuleRef','JWT_SECRET','get','object','@nestjs/passport','validateToken','slice','globalConfigService','Bearer','@nestjs/core','201816yjDPzK','decorate','RedisCacheService','getRequest','function','__metadata','10vhoNiF','89335hUIxRD','1134558ApvCRd','redisCacheService','metadata','authService','UNAUTHORIZED','extractToken','authorization','18984pBcGut','@nestjs/common','user','HttpException','canActivate','8JMqyQP','getNineAiToken','getOwnPropertyDescriptor','moduleRef','395UuZXow','checkTokenAuth','../../modules/globalConfig/globalConfig.service','x-website-domain','toString','90186AYOBRR','885059DpWeQD','10beNGuz','UnauthorizedException','HttpStatus','length','AuthGuard'];_0x2616=function(){return _0x259d4d;};return _0x2616();}let JwtAuthGuard=class JwtAuthGuard extends(0x0,passport_1[_0x3a95fb(0xa4)])('jwt'){constructor(_0x39c9f0,_0x1198ea,_0x5a7ef2,_0x1738ae){const _0x6938ed=_0x3a95fb;super(),this[_0x6938ed(0x8a)]=_0x39c9f0,this[_0x6938ed(0x98)]=_0x1198ea,this[_0x6938ed(0xb7)]=_0x5a7ef2,this[_0x6938ed(0x8c)]=_0x1738ae;}async[_0x3a95fb(0x94)](_0x422407){const _0x175d4c=_0x3a95fb;!this[_0x175d4c(0x8a)]&&(this['redisCacheService']=this[_0x175d4c(0x98)][_0x175d4c(0xb2)](redisCache_service_1[_0x175d4c(0xbc)],{'strict':![]}));const _0x51ed4f=_0x422407['switchToHttp']()[_0x175d4c(0xbd)](),_0x273894=_0x51ed4f['headers'][_0x175d4c(0x9c)],_0x3ffe3d=this[_0x175d4c(0x8e)](_0x51ed4f);_0x51ed4f[_0x175d4c(0x92)]=this[_0x175d4c(0xb5)](_0x3ffe3d);const _0x38ef37=this[_0x175d4c(0xb7)][_0x175d4c(0x96)]();return await this[_0x175d4c(0x8a)][_0x175d4c(0x9a)](_0x3ffe3d,_0x51ed4f),!![];}[_0x3a95fb(0x8e)](_0x367bd3){const _0x345e2c=_0x3a95fb;if(!_0x367bd3[_0x345e2c(0xaa)][_0x345e2c(0x8f)]){if(_0x367bd3[_0x345e2c(0xaa)][_0x345e2c(0xad)]){let _0x54a2f8=_0x367bd3[_0x345e2c(0xaa)][_0x345e2c(0xad)];_0x54a2f8>0x7fffffff&&(_0x54a2f8=_0x54a2f8[_0x345e2c(0x9d)]()[_0x345e2c(0xb6)](-0x9),_0x54a2f8=Number(String(Number(_0x54a2f8))));const _0x22b0b8=this[_0x345e2c(0x8c)]['createTokenFromFingerprint'](_0x54a2f8);return _0x22b0b8;}return null;}const _0x3a799a=_0x367bd3['headers']['authorization']['split']('\x20');if(_0x3a799a[_0x345e2c(0xa3)]!==0x2||_0x3a799a[0x0]!==_0x345e2c(0xb8))return null;return _0x3a799a[0x1];}[_0x3a95fb(0xb5)](_0x18d809){const _0x34b9de=_0x3a95fb;try{return jwt[_0x34b9de(0xab)](_0x18d809,process['env'][_0x34b9de(0xb1)]);}catch(_0x4a0ecf){throw new common_1[(_0x34b9de(0x93))](_0x34b9de(0xae),common_1[_0x34b9de(0xa2)][_0x34b9de(0x8d)]);}}[_0x3a95fb(0xa7)](_0x349726,_0x44e1ea,_0x93565){const _0x3fcf7d=_0x3a95fb;if(_0x349726||!_0x44e1ea){console['log']('err:\x20',_0x349726);throw _0x349726||new common_1[(_0x3fcf7d(0xa1))]();}return _0x44e1ea;}};JwtAuthGuard=__decorate([(0x0,common_1['Injectable'])(),__metadata(_0x3a95fb(0xaf),[redisCache_service_1[_0x3a95fb(0xbc)],core_1[_0x3a95fb(0xb0)],globalConfig_service_1[_0x3a95fb(0xa8)],auth_service_1[_0x3a95fb(0xa6)]])],JwtAuthGuard),exports[_0x3a95fb(0xac)]=JwtAuthGuard;