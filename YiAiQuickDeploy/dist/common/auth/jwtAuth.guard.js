'use strict';const _0x3631c1=_0x3087;function _0x3087(_0x22f3c5,_0x13dad9){const _0x37d67f=_0x37d6();return _0x3087=function(_0x30873a,_0x49210b){_0x30873a=_0x30873a-0x1aa;let _0x2ce459=_0x37d67f[_0x30873a];return _0x2ce459;},_0x3087(_0x22f3c5,_0x13dad9);}(function(_0x496a7f,_0x1da9c6){const _0x183563=_0x3087,_0x3e12ab=_0x496a7f();while(!![]){try{const _0x2be83b=parseInt(_0x183563(0x1d7))/0x1*(-parseInt(_0x183563(0x1d3))/0x2)+parseInt(_0x183563(0x1ad))/0x3*(-parseInt(_0x183563(0x1bd))/0x4)+-parseInt(_0x183563(0x1b1))/0x5*(parseInt(_0x183563(0x1df))/0x6)+parseInt(_0x183563(0x1e1))/0x7+-parseInt(_0x183563(0x1b3))/0x8*(parseInt(_0x183563(0x1e0))/0x9)+parseInt(_0x183563(0x1be))/0xa*(parseInt(_0x183563(0x1ac))/0xb)+parseInt(_0x183563(0x1b0))/0xc*(parseInt(_0x183563(0x1d9))/0xd);if(_0x2be83b===_0x1da9c6)break;else _0x3e12ab['push'](_0x3e12ab['shift']());}catch(_0x1414dd){_0x3e12ab['push'](_0x3e12ab['shift']());}}}(_0x37d6,0x77474));var __decorate=this&&this[_0x3631c1(0x1ab)]||function(_0xb4e5b1,_0x2caddc,_0x4c9662,_0x1ee236){const _0x176f39=_0x3631c1;var _0x4da695=arguments[_0x176f39(0x1bc)],_0x272a00=_0x4da695<0x3?_0x2caddc:_0x1ee236===null?_0x1ee236=Object['getOwnPropertyDescriptor'](_0x2caddc,_0x4c9662):_0x1ee236,_0x7e78cd;if(typeof Reflect===_0x176f39(0x1c7)&&typeof Reflect[_0x176f39(0x1db)]===_0x176f39(0x1ba))_0x272a00=Reflect[_0x176f39(0x1db)](_0xb4e5b1,_0x2caddc,_0x4c9662,_0x1ee236);else{for(var _0x42d345=_0xb4e5b1[_0x176f39(0x1bc)]-0x1;_0x42d345>=0x0;_0x42d345--)if(_0x7e78cd=_0xb4e5b1[_0x42d345])_0x272a00=(_0x4da695<0x3?_0x7e78cd(_0x272a00):_0x4da695>0x3?_0x7e78cd(_0x2caddc,_0x4c9662,_0x272a00):_0x7e78cd(_0x2caddc,_0x4c9662))||_0x272a00;}return _0x4da695>0x3&&_0x272a00&&Object[_0x176f39(0x1b6)](_0x2caddc,_0x4c9662,_0x272a00),_0x272a00;},__metadata=this&&this['__metadata']||function(_0x4b51c7,_0x54cb0b){const _0x1ae07f=_0x3631c1;if(typeof Reflect===_0x1ae07f(0x1c7)&&typeof Reflect['metadata']===_0x1ae07f(0x1ba))return Reflect[_0x1ae07f(0x1b8)](_0x4b51c7,_0x54cb0b);};function _0x37d6(){const _0x3c2e0b=['UNAUTHORIZED','../../modules/redisCache/redisCache.service','x-website-domain','../../modules/auth/auth.service','env','object','AuthService','HttpStatus','switchToHttp','createTokenFromFingerprint','get','@nestjs/core','HttpException','user','__esModule','globalConfigService','authorization','11082VsFxep','extractToken','log','authService','110NgBbyU','verify','49881xHygiY','validateToken','decorate','@nestjs/passport','../../modules/globalConfig/globalConfig.service','headers','5685210fJdNCf','9rQZGXg','827400DXrrwr','fingerprint','Injectable','ModuleRef','__decorate','11zZtBXl','17115gyeQNg','RedisCacheService','UnauthorizedException','6576bjGbGY','5YkPeHf','checkTokenAuth','3858392RNZGzV','moduleRef','redisCacheService','defineProperty','toString','metadata','Bearer','function','GlobalConfigService','length','148ddGLhv','5181170RdEvxG','jwt','canActivate','JwtAuthGuard'];_0x37d6=function(){return _0x3c2e0b;};return _0x37d6();}Object['defineProperty'](exports,_0x3631c1(0x1d0),{'value':!![]}),exports['JwtAuthGuard']=void 0x0;const redisCache_service_1=require(_0x3631c1(0x1c3)),common_1=require('@nestjs/common'),passport_1=require(_0x3631c1(0x1dc)),jwt=require('jsonwebtoken'),core_1=require(_0x3631c1(0x1cd)),globalConfig_service_1=require(_0x3631c1(0x1dd)),auth_service_1=require(_0x3631c1(0x1c5));let JwtAuthGuard=class JwtAuthGuard extends(0x0,passport_1['AuthGuard'])(_0x3631c1(0x1bf)){constructor(_0x5e94cb,_0x437270,_0x31f079,_0x180696){const _0x323469=_0x3631c1;super(),this['redisCacheService']=_0x5e94cb,this[_0x323469(0x1b4)]=_0x437270,this['globalConfigService']=_0x31f079,this[_0x323469(0x1d6)]=_0x180696;}async[_0x3631c1(0x1c0)](_0x57bfdd){const _0x2f91d1=_0x3631c1;!this['redisCacheService']&&(this[_0x2f91d1(0x1b5)]=this[_0x2f91d1(0x1b4)][_0x2f91d1(0x1cc)](redisCache_service_1[_0x2f91d1(0x1ae)],{'strict':![]}));const _0x482eb2=_0x57bfdd[_0x2f91d1(0x1ca)]()['getRequest'](),_0x15829a=_0x482eb2['headers'][_0x2f91d1(0x1c4)],_0x4ebc2b=this[_0x2f91d1(0x1d4)](_0x482eb2);_0x482eb2[_0x2f91d1(0x1cf)]=this[_0x2f91d1(0x1da)](_0x4ebc2b);const _0x1091d7=this[_0x2f91d1(0x1d1)]['getNineAiToken']();return await this[_0x2f91d1(0x1b5)][_0x2f91d1(0x1b2)](_0x4ebc2b,_0x482eb2),!![];}['extractToken'](_0x2efd10){const _0x583451=_0x3631c1;if(!_0x2efd10[_0x583451(0x1de)][_0x583451(0x1d2)]){if(_0x2efd10['headers'][_0x583451(0x1e2)]){let _0x1c2926=_0x2efd10['headers'][_0x583451(0x1e2)];_0x1c2926>0x7fffffff&&(_0x1c2926=_0x1c2926[_0x583451(0x1b7)]()['slice'](-0x9),_0x1c2926=Number(String(Number(_0x1c2926))));const _0x304a0a=this['authService'][_0x583451(0x1cb)](_0x1c2926);return _0x304a0a;}return null;}const _0xdf940e=_0x2efd10[_0x583451(0x1de)]['authorization']['split']('\x20');if(_0xdf940e['length']!==0x2||_0xdf940e[0x0]!==_0x583451(0x1b9))return null;return _0xdf940e[0x1];}['validateToken'](_0x4292d6){const _0x4825d4=_0x3631c1;try{return jwt[_0x4825d4(0x1d8)](_0x4292d6,process[_0x4825d4(0x1c6)]['JWT_SECRET']);}catch(_0x287c66){throw new common_1[(_0x4825d4(0x1ce))]('亲爱的用户,请登录后继续操作,我们正在等您的到来！',common_1[_0x4825d4(0x1c9)][_0x4825d4(0x1c2)]);}}['handleRequest'](_0x282dd8,_0x17dfa3,_0x3f8d4e){const _0x5bc478=_0x3631c1;if(_0x282dd8||!_0x17dfa3){console[_0x5bc478(0x1d5)]('err:\x20',_0x282dd8);throw _0x282dd8||new common_1[(_0x5bc478(0x1af))]();}return _0x17dfa3;}};JwtAuthGuard=__decorate([(0x0,common_1[_0x3631c1(0x1e3)])(),__metadata('design:paramtypes',[redisCache_service_1[_0x3631c1(0x1ae)],core_1[_0x3631c1(0x1aa)],globalConfig_service_1[_0x3631c1(0x1bb)],auth_service_1[_0x3631c1(0x1c8)]])],JwtAuthGuard),exports[_0x3631c1(0x1c1)]=JwtAuthGuard;