'use strict';const _0x4d0fcf=_0x4d91;function _0x4d91(_0xed9c7f,_0x3c3bae){const _0x2179b7=_0x2179();return _0x4d91=function(_0x4d913e,_0x1c0375){_0x4d913e=_0x4d913e-0xf0;let _0x4d61c9=_0x2179b7[_0x4d913e];return _0x4d61c9;},_0x4d91(_0xed9c7f,_0x3c3bae);}(function(_0x46db09,_0x36c99f){const _0x1e2a54=_0x4d91,_0x544977=_0x46db09();while(!![]){try{const _0x5d4754=parseInt(_0x1e2a54(0xfe))/0x1+-parseInt(_0x1e2a54(0x112))/0x2*(-parseInt(_0x1e2a54(0x113))/0x3)+-parseInt(_0x1e2a54(0x110))/0x4*(-parseInt(_0x1e2a54(0x119))/0x5)+parseInt(_0x1e2a54(0xf2))/0x6*(-parseInt(_0x1e2a54(0xf5))/0x7)+-parseInt(_0x1e2a54(0x10d))/0x8+-parseInt(_0x1e2a54(0xfd))/0x9+parseInt(_0x1e2a54(0x10a))/0xa;if(_0x5d4754===_0x36c99f)break;else _0x544977['push'](_0x544977['shift']());}catch(_0x530b71){_0x544977['push'](_0x544977['shift']());}}}(_0x2179,0x22a47));var __decorate=this&&this[_0x4d0fcf(0x11b)]||function(_0x295378,_0x174174,_0x38aec7,_0x1e521c){const _0x328c9a=_0x4d0fcf;var _0xa86e5a=arguments['length'],_0x3ef66a=_0xa86e5a<0x3?_0x174174:_0x1e521c===null?_0x1e521c=Object['getOwnPropertyDescriptor'](_0x174174,_0x38aec7):_0x1e521c,_0x3cbb3e;if(typeof Reflect===_0x328c9a(0x105)&&typeof Reflect['decorate']===_0x328c9a(0xf1))_0x3ef66a=Reflect[_0x328c9a(0x11d)](_0x295378,_0x174174,_0x38aec7,_0x1e521c);else{for(var _0x31303b=_0x295378['length']-0x1;_0x31303b>=0x0;_0x31303b--)if(_0x3cbb3e=_0x295378[_0x31303b])_0x3ef66a=(_0xa86e5a<0x3?_0x3cbb3e(_0x3ef66a):_0xa86e5a>0x3?_0x3cbb3e(_0x174174,_0x38aec7,_0x3ef66a):_0x3cbb3e(_0x174174,_0x38aec7))||_0x3ef66a;}return _0xa86e5a>0x3&&_0x3ef66a&&Object['defineProperty'](_0x174174,_0x38aec7,_0x3ef66a),_0x3ef66a;},__metadata=this&&this['__metadata']||function(_0x2dee83,_0x3677e9){const _0x369bc6=_0x4d0fcf;if(typeof Reflect==='object'&&typeof Reflect[_0x369bc6(0x124)]===_0x369bc6(0xf1))return Reflect[_0x369bc6(0x124)](_0x2dee83,_0x3677e9);};Object['defineProperty'](exports,_0x4d0fcf(0x100),{'value':!![]}),exports[_0x4d0fcf(0xff)]=void 0x0;const redisCache_service_1=require(_0x4d0fcf(0x115)),common_1=require(_0x4d0fcf(0xf4)),passport_1=require(_0x4d0fcf(0x123)),jwt=require('jsonwebtoken'),core_1=require('@nestjs/core'),globalConfig_service_1=require(_0x4d0fcf(0xfa)),auth_service_1=require(_0x4d0fcf(0x111));let JwtAuthGuard=class JwtAuthGuard extends(0x0,passport_1[_0x4d0fcf(0x107)])(_0x4d0fcf(0x106)){constructor(_0x42b868,_0x1085ba,_0x4c81ea,_0x447946){const _0x10c0b6=_0x4d0fcf;super(),this[_0x10c0b6(0x102)]=_0x42b868,this[_0x10c0b6(0xf8)]=_0x1085ba,this[_0x10c0b6(0xf3)]=_0x4c81ea,this[_0x10c0b6(0x109)]=_0x447946;}async[_0x4d0fcf(0x127)](_0x3725a4){const _0x47b732=_0x4d0fcf;!this['redisCacheService']&&(this[_0x47b732(0x102)]=this[_0x47b732(0xf8)]['get'](redisCache_service_1[_0x47b732(0x103)],{'strict':![]}));const _0x22e9df=_0x3725a4[_0x47b732(0xfc)]()[_0x47b732(0xf9)](),_0x5156ff=_0x22e9df[_0x47b732(0x121)][_0x47b732(0x104)],_0x2e07c3=this[_0x47b732(0xf0)](_0x22e9df);_0x22e9df[_0x47b732(0x114)]=this[_0x47b732(0x120)](_0x2e07c3);const _0x37040b=this[_0x47b732(0xf3)][_0x47b732(0x11f)]();return await this[_0x47b732(0x102)]['checkTokenAuth'](_0x2e07c3,_0x22e9df),!![];}['extractToken'](_0x265923){const _0x5c1e96=_0x4d0fcf;if(!_0x265923['headers']['authorization']){if(_0x265923['headers']['fingerprint']){let _0x46796d=_0x265923[_0x5c1e96(0x121)][_0x5c1e96(0x125)];_0x46796d>0x7fffffff&&(_0x46796d=_0x46796d['toString']()[_0x5c1e96(0x126)](-0x9),_0x46796d=Number(String(Number(_0x46796d))));const _0x2376ef=this['authService'][_0x5c1e96(0x117)](_0x46796d);return _0x2376ef;}return null;}const _0x5ef5a6=_0x265923[_0x5c1e96(0x121)][_0x5c1e96(0x11e)]['split']('\x20');if(_0x5ef5a6[_0x5c1e96(0x122)]!==0x2||_0x5ef5a6[0x0]!==_0x5c1e96(0x11a))return null;return _0x5ef5a6[0x1];}[_0x4d0fcf(0x120)](_0x41d5e6){const _0x23e363=_0x4d0fcf;try{return jwt[_0x23e363(0x10b)](_0x41d5e6,process['env']['JWT_SECRET']);}catch(_0x4a67bc){throw new common_1['HttpException'](_0x23e363(0x10f),common_1[_0x23e363(0xfb)][_0x23e363(0xf7)]);}}[_0x4d0fcf(0x108)](_0x63d7c9,_0x39a03d,_0xc415ed){const _0x214af7=_0x4d0fcf;if(_0x63d7c9||!_0x39a03d){console[_0x214af7(0x101)]('err:\x20',_0x63d7c9);throw _0x63d7c9||new common_1[(_0x214af7(0x11c))]();}return _0x39a03d;}};function _0x2179(){const _0x17b6b4=['length','@nestjs/passport','metadata','fingerprint','slice','canActivate','extractToken','function','281922fUdPfv','globalConfigService','@nestjs/common','21gHAQBw','ModuleRef','UNAUTHORIZED','moduleRef','getRequest','../../modules/globalConfig/globalConfig.service','HttpStatus','switchToHttp','2554011mkVLDD','138976uxhIzp','JwtAuthGuard','__esModule','log','redisCacheService','RedisCacheService','x-website-domain','object','jwt','AuthGuard','handleRequest','authService','623070wAbCqy','verify','design:paramtypes','622480PTOsEr','GlobalConfigService','亲爱的用户,请登录后继续操作,我们正在等您的到来！','4oIKPlt','../../modules/auth/auth.service','2ORteyI','704463sMlWre','user','../../modules/redisCache/redisCache.service','Injectable','createTokenFromFingerprint','AuthService','1041705XySCvo','Bearer','__decorate','UnauthorizedException','decorate','authorization','getNineAiToken','validateToken','headers'];_0x2179=function(){return _0x17b6b4;};return _0x2179();}JwtAuthGuard=__decorate([(0x0,common_1[_0x4d0fcf(0x116)])(),__metadata(_0x4d0fcf(0x10c),[redisCache_service_1['RedisCacheService'],core_1[_0x4d0fcf(0xf6)],globalConfig_service_1[_0x4d0fcf(0x10e)],auth_service_1[_0x4d0fcf(0x118)]])],JwtAuthGuard),exports['JwtAuthGuard']=JwtAuthGuard;